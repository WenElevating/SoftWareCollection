webpackJsonp([4],{"/DTV":function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:["modal",{fade:e.fade}],attrs:{"data-backdrop":"static","data-disable":"false","data-keyboard":"true",tabindex:"-1"}},[a("div",{class:["modal-dialog",e.size]},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header"},[e._m(0),e._v(" "),a("h4",{staticClass:"modal-title text-center text-primary"},[a("span",[e._v(e._s(e.title))])])]),e._v(" "),a("div",{staticClass:"modal-body"},[a("div",{staticClass:"form-inline",attrs:{autocomplete:"off",spellcheck:"false"}},[a("div",{staticClass:"form-group form-group-sm"},[a("label",[e._v("搜索")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.q,expression:"q",modifiers:{trim:!0}}],ref:"q",staticClass:"form-control",attrs:{type:"text",placeholder:"关键字"},domProps:{value:e.q},on:{keydown:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;t.preventDefault()},input:function(t){t.target.composing||(e.q=t.target.value.trim())},blur:function(t){e.$forceUpdate()}}})]),e._v(" "),a("span",{staticClass:"hidden-xs"},[e._v("  ")]),e._v(" "),a("div",{staticClass:"form-group form-group-sm"},[a("label",[e._v("通道类型")]),e._v(" "),a("select",{directives:[{name:"model",rawName:"v-model.trim",value:e.channel_type,expression:"channel_type",modifiers:{trim:!0}}],staticClass:"form-control",on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.channel_type=t.target.multiple?a:a[0]}}},[a("option",{attrs:{value:""}},[e._v("全部")]),e._v(" "),a("option",{attrs:{value:"device"}},[e._v("设备")]),e._v(" "),a("option",{attrs:{value:"dir"}},[e._v("子目录")])])]),e._v(" "),a("span",{staticClass:"hidden-xs"},[e._v("  ")]),e._v(" "),"device"==e.channel_type?a("div",{staticClass:"form-group form-group-sm"},[a("label",[e._v("在线状态")]),e._v(" "),a("select",{directives:[{name:"model",rawName:"v-model.trim",value:e.online,expression:"online",modifiers:{trim:!0}}],staticClass:"form-control",on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.online=t.target.multiple?a:a[0]}}},[a("option",{attrs:{value:""}},[e._v("全部")]),e._v(" "),a("option",{attrs:{value:"true"}},[e._v("在线")]),e._v(" "),a("option",{attrs:{value:"false"}},[e._v("离线")])])]):e._e(),e._v(" "),"device"==e.channel_type?a("span",{staticClass:"hidden-xs"},[e._v("  ")]):e._e(),e._v(" "),a("div",{staticClass:"form-group form-group-sm"},[a("div",{staticClass:"checkbox",staticStyle:{"user-select":"none"}},[a("el-checkbox",{staticStyle:{"margin-top":"-5px","padding-left":"0"},attrs:{size:"small",name:"Related"},model:{value:e.related,callback:function(t){e.related="string"==typeof t?t.trim():t},expression:"related"}},[e._v("\n                                只看"+e._s(e.reverse?"未选":"已选")+"("+e._s(e.relateCnt)+")\n                            ")]),e._v(" "),a("span",[a("a",{attrs:{role:"button"},on:{click:e.toggleReverse}},[a("i",{staticClass:"fa fa-sort"})])])],1)])]),e._v(" "),a("br"),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"channelTable",attrs:{data:e.channels,stripe:"","max-height":500,"element-loading-text":"加载中..."},on:{"sort-change":e.sortChange,select:e.select,"select-all":e.selectAll}},[a("el-table-column",{attrs:{type:"selection",width:"55",fixed:"",selectable:e.selectable}}),e._v(" "),a("el-table-column",{attrs:{prop:"DeviceID",label:"设备国标编号","min-width":"200","show-overflow-tooltip":"",sortable:"custom"}}),e._v(" "),a("el-table-column",{attrs:{prop:"ID",label:"通道国标编号","min-width":"200","show-overflow-tooltip":"",sortable:"custom"}}),e._v(" "),"标准版"!=e.serverInfo.VersionType?a("el-table-column",{attrs:{prop:"CustomID",label:"自定义通道国标编号","min-width":"200","show-overflow-tooltip":"",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.Editing?a("input",{directives:[{name:"focus",rawName:"v-focus"}],staticStyle:{width:"170px",padding:"2px","line-height":"100%"},attrs:{type:"text",oninput:"value=value.replace(/[^\\d]/g,'')"},domProps:{value:t.row.CustomID||t.row.ID},on:{keydown:[function(a){if(!("button"in a)&&e._k(a.keyCode,"esc",27,a.key))return null;a.stopPropagation(),a.preventDefault(),e.setChannelID(t.row,!1,a)},function(a){if(!("button"in a)&&e._k(a.keyCode,"enter",13,a.key))return null;a.stopPropagation(),a.preventDefault(),e.setChannelID(t.row,!1,a)}],blur:function(a){e.setChannelID(t.row,!1,a)}}}):a("a",{class:{"text-orange":!!t.row.CustomID},attrs:{role:"button"},on:{click:function(a){a.preventDefault(),e.setChannelID(t.row,!0,a)}}},[e._v(e._s(t.row.CustomID||t.row.ID))])]}}])}):e._e(),e._v(" "),a("el-table-column",{attrs:{prop:"Name",label:"通道名称","min-width":"160",formatter:e.formatName,"show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"100",label:"快照"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.isDir(t.row)?a("span",[a("i",{staticClass:"fa fa-sitemap"})]):a("el-popover",{attrs:{"open-delay":1e3,"close-delay":10,placement:"left",title:t.row.ID,width:"400",trigger:"hover"}},[a("img",{staticStyle:{width:"100%",height:"100%"},attrs:{onerror:"this.src='/images/default_snap.png';",src:t.row.SnapURL}}),e._v(" "),a("img",{staticStyle:{height:"30px",width:"50px"},attrs:{slot:"reference",onerror:"this.src='/images/default_snap.png';",src:t.row.SnapURL},slot:"reference"})])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"Status",label:"在线状态","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.isDir(t.row)?a("span",[e._v("-")]):t.row.DeviceOnline&&"ON"==(t.row.CustomStatus||t.row.Status)?a("span",{class:{"text-success":"ON"==t.row.Status,"text-orange":!!t.row.CustomStatus}},[e._v("在线")]):a("span",{class:{"text-orange":!!t.row.CustomStatus}},[e._v("离线")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"Manufacturer",label:"厂家","min-width":"120",formatter:e.formatManufacturer,"show-overflow-tooltip":""}})],1),e._v(" "),e.total>0?a("el-pagination",{staticClass:"pull-right",attrs:{layout:"total,prev,pager,next,sizes","pager-count":e.isMobile()?3:5,total:e.total,"page-size":e.pageSize,"current-page":e.currentPage},on:{"update:pageSize":function(t){e.pageSize=t},"update:currentPage":function(t){e.currentPage=t}}}):e._e(),e._v(" "),a("div",{staticClass:"clearfix"})],1)])])])},n=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("span",{attrs:{"aria-hidden":"true"}},[e._v("×")])])}],r={render:o,staticRenderFns:n};t.a=r},"/aob":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("RUmD"),n=a.n(o);for(var r in o)["default","default"].indexOf(r)<0&&function(e){a.d(t,e,function(){return o[e]})}(r);var s=a("Tykz"),i=a("VU/8"),l=i(n.a,s.a,!1,null,null,null);t.default=l.exports},"04UO":function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("br"),a("br",{staticClass:"hidden-xs"}),e._v(" "),a("div",{staticClass:"row hidden-xs"},[a("div",{staticClass:"text-center"},[a("el-button-group",{staticClass:"player-btn-group"},[e._l(e.playerBtnGroup,function(t){return a("el-button",{key:t.num,class:{active:e.playerLength==t.num},attrs:{type:"primary",size:"medium"},on:{click:function(a){a.preventDefault(),e.setPlayerLength(t.num)}}},[e._v(e._s(t.name))])}),e._v(" "),e.isIE()?e._e():a("el-button",{attrs:{type:"primary",size:"medium",title:e.loopPlaying?"停止轮巡播放":"选择轮巡播放通道"},on:{click:function(t){t.preventDefault(),e.loopPlaying?e.stopLoopPlay():e.showLoopPlayListDlg()}}},[e.loopPlaying?a("i",{staticClass:"fa fa-stop",staticStyle:{color:"#dd4b39"}}):a("span",[e._v("轮播")])]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"medium",title:"全屏显示"},on:{click:function(t){t.preventDefault(),e.fullscreen(t)}}},[a("i",{staticClass:"fa fa-arrows-alt"})]),e._v(" "),!e.loopPlaying&&e.hasLocalData()?a("el-button",{attrs:{type:"primary",size:"medium",title:"点击加载上次记录"},on:{click:function(t){t.preventDefault(),e.loadLocalData(!0)}}},[a("i",{staticClass:"fa fa-database"})]):e._e()],2)],1)]),e._v(" "),a("div",{staticClass:"row visible-xs text-center"},[a("el-button-group",{staticClass:"player-btn-group"},e._l(e.playerBtnGroup,function(t){return a("el-button",{key:t.num,class:{active:e.playerLength==t.num},attrs:{type:"primary",size:"mini"},on:{click:function(a){a.preventDefault(),e.setPlayerLength(t.num)}}},[e._v(e._s(t.name))])}))],1),e._v(" "),a("br"),a("br",{staticClass:"hidden-xs"}),e._v(" "),a("div",{staticClass:"view-list row"},[a("div",{staticClass:"col-md-3",attrs:{id:"dev-tree-left"}},[a("div",{attrs:{autocomplete:"off",spellcheck:"false"}},[a("div",{staticClass:"form-group form-group-sm"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.q,expression:"q"}],ref:"q",staticClass:"form-control",attrs:{type:"text",placeholder:"搜索"},domProps:{value:e.q},on:{keydown:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;t.preventDefault()},input:function(t){t.target.composing||(e.q=t.target.value)}}})])]),e._v(" "),a("ul",{staticClass:"nav nav-tabs"},[a("li",{staticClass:"active",on:{click:function(t){e.switchTab("dev")}}},[a("a",{attrs:{href:"#dev-tree-wrapper","data-toggle":"tab"}},[e._v("设备树")])]),e._v(" "),a("li",{on:{click:function(t){e.switchTab("group")}}},[a("a",{attrs:{href:"#group-tree-wrapper","data-toggle":"tab"}},[e._v("分 组")])])]),e._v(" "),a("div",{staticClass:"tab-content",staticStyle:{margin:"10px 0"},attrs:{id:"tab-tree-wrapper"}},[a("div",{ref:"devTreeWrapper",staticClass:"tab-pane active",attrs:{id:"dev-tree-wrapper"}},[e.showQueryDevTree?a("el-tree",{ref:"queryDevTree",attrs:{id:"query-dev-tree","node-key":"key",data:e.queryDevTreeDataList,props:e.treeProps,load:e.queryDevTreeLoad,lazy:"","empty-text":e.queryDevTreeEmptyText},on:{"node-click":e.treeNodeClick,"node-contextmenu":e.treeNodeRightClick},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.node,n=t.data;return a("span",{staticClass:"custom-tree-node"},[n.parentID?a("i",{staticClass:"glyphicon glyphicon-arrow-up",style:e.treeLeaf(n)?"color:#c0c4cc;font-size:12px;margin-left:-16px;":"color:#c0c4cc;font-size:12px;",attrs:{title:"点击查询上一层"},on:{click:function(t){t.stopPropagation(),e.q="code:"+n.parentID}}}):e._e(),e._v(" "),a("span",{class:{"text-green":e.treeLeaf(n)&&"ON"===n.status}},[a("i",{class:["fa",{"fa-sitemap":!e.treeLeaf(n),"fa-camera":e.treeLeaf(n),"fa-spinner":o.playing,"fa-spin":o.playing,"fa-play":o.play}]}),e._v(" "),a("span",{staticClass:"ellipsis",staticStyle:{"user-select":"none"},attrs:{title:o.label}},[e._v(e._s(o.label))])])])}}])}):e._e(),e._v(" "),e.showTree?a("el-tree",{directives:[{name:"show",rawName:"v-show",value:!e.showQueryDevTree,expression:"!showQueryDevTree"}],ref:"devTree",attrs:{id:"dev-tree","node-key":"key",props:e.treeProps,load:e.treeLoad,"filter-node-method":e.devTreeFilter,lazy:"","empty-text":e.treeEmptyText,"default-expanded-keys":e.defExpandDevs},on:{"node-click":e.treeNodeClick,"node-contextmenu":e.treeNodeRightClick},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.node,n=t.data;return a("span",{staticClass:"custom-tree-node"},[a("span",{class:{"text-green":e.treeLeaf(n)&&"ON"===n.status}},[a("i",{class:["fa",{"fa-sitemap":!e.treeLeaf(n),"fa-camera":e.treeLeaf(n),"fa-spinner":o.playing,"fa-spin":o.playing,"fa-play":o.play}]}),e._v(" "),a("span",{staticClass:"ellipsis",staticStyle:{"user-select":"none"},attrs:{title:o.label}},[e._v(e._s(o.label))])])])}}])}):e._e()],1),e._v(" "),a("div",{ref:"groupTreeWrapper",staticClass:"tab-pane",attrs:{id:"group-tree-wrapper"}},[e.showQueryGroupTree?a("el-tree",{ref:"queryGroupTree",attrs:{id:"query-group-tree","node-key":"key",data:e.queryGroupTreeDataList,props:e.treeProps,load:e.queryGroupTreeLoad,lazy:"","empty-text":e.queryGroupTreeEmptyText,draggable:e.hasAnyRole(e.serverInfo,e.userInfo,"管理员","超级管理员")&&!e.isMobile(),"allow-drag":e.allowDrag,"allow-drop":e.allowDrop},on:{"node-drop":e.handleDrop,"node-click":e.treeNodeClick,"node-contextmenu":e.treeNodeRightClick},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.node,n=t.data;return a("span",{staticClass:"custom-tree-node"},[n.parentID?a("i",{staticClass:"glyphicon glyphicon-arrow-up",style:e.treeLeaf(n)?"color:#c0c4cc;font-size:12px;margin-left:-16px;":"color:#c0c4cc;font-size:12px;",attrs:{title:"点击查询上一层"},on:{click:function(t){t.stopPropagation(),e.q="code:"+n.parentID}}}):e._e(),e._v(" "),a("span",{class:{"text-green":e.treeLeaf(n)&&"ON"===n.status}},[a("i",{class:["fa",{"fa-sitemap":!e.treeLeaf(n),"fa-camera":e.treeLeaf(n),"fa-spinner":o.playing,"fa-spin":o.playing,"fa-play":o.play}]}),e._v(" "),a("span",{class:["ellipsis",{"text-bold":!!n.custom,"text-under-dashed":o.parent&&o.parent.data&&!1===o.parent.data.custom}],staticStyle:{"user-select":"none"},attrs:{title:o.label}},[e._v(e._s(o.label))])])])}}])}):e._e(),e._v(" "),e.showGroupTree?a("el-tree",{directives:[{name:"show",rawName:"v-show",value:!e.showQueryGroupTree,expression:"!showQueryGroupTree"}],ref:"groupTree",attrs:{id:"group-tree","node-key":"key",props:e.treeProps,load:e.groupTreeLoad,"filter-node-method":e.groupTreeFilter,lazy:"","empty-text":e.groupTreeEmptyText,"default-expanded-keys":e.defExpandGroups,draggable:e.hasAnyRole(e.serverInfo,e.userInfo,"管理员","超级管理员")&&!e.isMobile(),"allow-drag":e.allowDrag,"allow-drop":e.allowDrop},on:{"node-drop":e.handleDrop,"node-click":e.treeNodeClick,"node-contextmenu":e.treeNodeRightClick},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.node,n=t.data;return a("span",{staticClass:"custom-tree-node"},[a("span",{class:{"text-green":e.treeLeaf(n)&&"ON"===n.status}},[a("i",{class:["fa",{"fa-home":!n.code,"fa-sitemap":n.code&&!e.treeLeaf(n),"fa-camera":e.treeLeaf(n),"fa-spinner":o.playing,"fa-spin":o.playing,"fa-play":o.play}]}),e._v(" "),o.level>1||n.subCount>0||e.q||e.isMobile()||!e.hasAnyRole(e.serverInfo,e.userInfo,"管理员","超级管理员")?a("span",{class:["ellipsis",{"text-bold":!!n.custom,"text-under-dashed":o.parent&&o.parent.data&&!1===o.parent.data.custom}],staticStyle:{"user-select":"none"},attrs:{title:o.label}},[e._v("\r\n                  "+e._s(o.label)+"\r\n                ")]):a("el-tooltip",{attrs:{content:"右键创建分组",placement:"right",manual:"",value:e.showTip}},[a("span",{staticClass:"ellipsis text-bold",staticStyle:{"user-select":"none"},attrs:{title:o.label}},[e._v(e._s(o.label))])])],1)])}}])}):e._e()],1)])]),e._v(" "),a("VueContextMenu",{staticClass:"right-menu",attrs:{target:e.contextMenuTarget,show:e.contextMenuVisible},on:{"update:show":function(t){return e.contextMenuVisible=t}}},[a("a",{directives:[{name:"show",rawName:"v-show",value:e.contextMenuNodeData&&!e.contextMenuNodeData.custom&&e.contextMenuNodeData.code&&e.contextMenuNode&&e.contextMenuNode.play&&!e.contextMenuNode.playing,expression:"contextMenuNodeData && !contextMenuNodeData.custom && contextMenuNodeData.code && contextMenuNode && contextMenuNode.play && !contextMenuNode.playing"}],attrs:{role:"button"},on:{click:function(t){e.playStop(e.contextMenuNode)}}},[a("i",{staticClass:"fa fa-stop"}),e._v(" 停止播放\r\n      ")]),e._v(" "),a("a",{directives:[{name:"show",rawName:"v-show",value:e.contextMenuNodeData,expression:"contextMenuNodeData"}],attrs:{role:"button"},on:{click:function(t){e.treeNodeRefresh(e.pnode)}}},[a("i",{staticClass:"fa fa-refresh"}),e._v(" 刷新节点\r\n      ")]),e._v(" "),a("a",{directives:[{name:"show",rawName:"v-show",value:e.contextMenuNodeData&&e.contextMenuNodeData.custom&&(e.contextMenuNodeData.code||e.hasAllChannel(e.serverInfo,e.userInfo))&&e.userInfo&&e.hasAnyRole(e.serverInfo,e.userInfo,"管理员","超级管理员"),expression:"contextMenuNodeData && contextMenuNodeData.custom && (contextMenuNodeData.code || hasAllChannel(serverInfo, userInfo)) && userInfo && hasAnyRole(serverInfo, userInfo, '管理员', '超级管理员')"}],attrs:{role:"button"},on:{click:e.showNodeAddDlg}},[a("i",{staticClass:"fa fa-plus"}),e._v(" 新建分组\r\n      ")]),e._v(" "),a("a",{directives:[{name:"show",rawName:"v-show",value:e.contextMenuNodeData&&!e.contextMenuNodeData.custom&&"virtual"===e.contextMenuNodeData.manufacturer&&e.contextMenuNodeData.code&&e.userInfo&&e.hasAnyRole(e.serverInfo,e.userInfo,"超级管理员"),expression:"contextMenuNodeData && !contextMenuNodeData.custom && contextMenuNodeData.manufacturer === 'virtual' && contextMenuNodeData.code && userInfo && hasAnyRole(serverInfo, userInfo, '超级管理员')"}],attrs:{role:"button"},on:{click:e.showNodeAddDlg}},[a("i",{staticClass:"fa fa-plus"}),e._v(" 新建节点\r\n      ")]),e._v(" "),a("a",{directives:[{name:"show",rawName:"v-show",value:e.contextMenuNodeData&&e.contextMenuNodeData.custom&&(e.contextMenuNodeData.code||e.hasAllChannel(e.serverInfo,e.userInfo))&&e.userInfo&&e.hasAnyRole(e.serverInfo,e.userInfo,"管理员","超级管理员"),expression:"contextMenuNodeData && contextMenuNodeData.custom && (contextMenuNodeData.code || hasAllChannel(serverInfo, userInfo)) && userInfo && hasAnyRole(serverInfo, userInfo, '管理员', '超级管理员')"}],attrs:{role:"button"},on:{click:e.showNodeImportDlg}},[a("i",{staticClass:"fa fa-arrow-right"}),e._v(" 导入设备\r\n      ")]),e._v(" "),a("a",{directives:[{name:"show",rawName:"v-show",value:e.contextMenuNodeData&&e.contextMenuNodeData.custom&&!e.contextMenuNodeData.code&&e.userInfo&&e.hasAnyRole(e.serverInfo,e.userInfo,"超级管理员"),expression:"contextMenuNodeData && contextMenuNodeData.custom && !contextMenuNodeData.code && userInfo && hasAnyRole(serverInfo, userInfo, '超级管理员')"}],attrs:{role:"button"},on:{click:e.exportGroup}},[a("i",{staticClass:"fa fa-download"}),e._v(" 导出分组\r\n      ")]),e._v(" "),a("a",{directives:[{name:"show",rawName:"v-show",value:e.contextMenuNodeData&&e.contextMenuNodeData.custom&&!e.contextMenuNodeData.code&&e.userInfo&&e.hasAnyRole(e.serverInfo,e.userInfo,"超级管理员"),expression:"contextMenuNodeData && contextMenuNodeData.custom && !contextMenuNodeData.code && userInfo && hasAnyRole(serverInfo, userInfo, '超级管理员')"}],attrs:{role:"button"},on:{click:e.importGroup}},[a("i",{staticClass:"fa fa-upload"}),e._v(" 导入分组\r\n      ")]),e._v(" "),a("a",{directives:[{name:"show",rawName:"v-show",value:e.contextMenuNodeData&&e.contextMenuNodeData.custom&&e.contextMenuNodeData.code&&e.userInfo&&e.hasAnyRole(e.serverInfo,e.userInfo,"管理员","超级管理员"),expression:"contextMenuNodeData && contextMenuNodeData.custom && contextMenuNodeData.code && userInfo && hasAnyRole(serverInfo, userInfo, '管理员', '超级管理员')"}],attrs:{role:"button"},on:{click:e.showCustomListDlg}},[a("i",{staticClass:"fa fa-check"}),e._v(" 选择通道\r\n      ")]),e._v(" "),a("a",{directives:[{name:"show",rawName:"v-show",value:e.contextMenuNodeData&&!e.contextMenuNodeData.custom&&e.userInfo&&e.hasAnyRole(e.serverInfo,e.userInfo,"管理员","超级管理员"),expression:"contextMenuNodeData && !contextMenuNodeData.custom && userInfo && hasAnyRole(serverInfo, userInfo, '管理员', '超级管理员')"}],attrs:{role:"button"},on:{click:e.showNodeEditDlg}},[a("i",{staticClass:"fa fa-edit"}),e._v(" 编辑名称\r\n      ")]),e._v(" "),a("a",{directives:[{name:"show",rawName:"v-show",value:e.contextMenuNodeData&&e.contextMenuNodeData.custom&&e.contextMenuNodeData.code&&e.userInfo&&e.hasAnyRole(e.serverInfo,e.userInfo,"管理员","超级管理员"),expression:"contextMenuNodeData && contextMenuNodeData.custom && contextMenuNodeData.code && userInfo && hasAnyRole(serverInfo, userInfo, '管理员', '超级管理员')"}],attrs:{role:"button"},on:{click:e.showNodeEditDlg}},[a("i",{staticClass:"fa fa-edit"}),e._v(" 编辑分组\r\n      ")]),e._v(" "),a("a",{directives:[{name:"show",rawName:"v-show",value:e.contextMenuNodeData&&!e.contextMenuNodeData.custom&&e.contextMenuNodeData.code&&e.userInfo&&e.hasAnyRole(e.serverInfo,e.userInfo,"管理员","超级管理员"),expression:"contextMenuNodeData && !contextMenuNodeData.custom && contextMenuNodeData.code && userInfo && hasAnyRole(serverInfo, userInfo, '管理员', '超级管理员')"}],attrs:{role:"button"},on:{click:e.showPositionEditDlg}},[a("i",{staticClass:"glyphicon glyphicon-map-marker"}),e._v(" 编辑位置\r\n      ")]),e._v(" "),a("a",{directives:[{name:"show",rawName:"v-show",value:e.contextMenuNodeData&&e.contextMenuNodeData.code&&e.userInfo&&e.hasAnyRole(e.serverInfo,e.userInfo,"超级管理员"),expression:"contextMenuNodeData && contextMenuNodeData.code && userInfo && hasAnyRole(serverInfo, userInfo, '超级管理员')"}],attrs:{role:"button"},on:{click:e.showNodeShareDlg}},[a("i",{staticClass:"fa fa-share"}),e._v(" 共享节点\r\n      ")]),e._v(" "),a("a",{directives:[{name:"show",rawName:"v-show",value:e.contextMenuNodeData&&e.contextMenuNodeData.custom&&e.contextMenuNodeData.code&&e.userInfo&&e.hasAnyRole(e.serverInfo,e.userInfo,"管理员","超级管理员"),expression:"contextMenuNodeData && contextMenuNodeData.custom && contextMenuNodeData.code && userInfo && hasAnyRole(serverInfo, userInfo, '管理员', '超级管理员')"}],attrs:{role:"button"},on:{click:e.removeCustomNode}},[a("i",{staticClass:"fa fa-remove"}),e._v(" 删除分组\r\n      ")]),e._v(" "),a("a",{directives:[{name:"show",rawName:"v-show",value:e.contextMenuNodeData&&!e.contextMenuNodeData.custom&&e.contextMenuNodeData.code&&e.pnode&&e.pnode.data&&e.pnode.data.custom&&e.userInfo&&e.hasAnyRole(e.serverInfo,e.userInfo,"管理员","超级管理员"),expression:"contextMenuNodeData && !contextMenuNodeData.custom && contextMenuNodeData.code && pnode && pnode.data && pnode.data.custom && userInfo && hasAnyRole(serverInfo, userInfo, '管理员', '超级管理员')"}],attrs:{role:"button"},on:{click:e.removeCustomNode}},[a("i",{staticClass:"fa fa-remove"}),e._v(" 移出分组\r\n      ")]),e._v(" "),a("a",{directives:[{name:"show",rawName:"v-show",value:e.contextMenuNodeData&&!e.contextMenuNodeData.custom&&"virtual"===e.contextMenuNodeData.manufacturer&&e.contextMenuNodeData.code&&e.userInfo&&e.hasAnyRole(e.serverInfo,e.userInfo,"超级管理员"),expression:"contextMenuNodeData && !contextMenuNodeData.custom && contextMenuNodeData.manufacturer === 'virtual' && contextMenuNodeData.code && userInfo && hasAnyRole(serverInfo, userInfo, '超级管理员')"}],attrs:{role:"button"},on:{click:e.removeVirtualNode}},[a("i",{staticClass:"fa fa-remove"}),e._v(" 删除节点\r\n      ")])]),e._v(" "),a("div",{staticClass:"row col-md-9",attrs:{id:"dev-tree-right"}},[a("div",{attrs:{id:"screen-sticky"}},[a("div",{staticClass:"video-show col-md-9 col-lg-10"},[a("div",[e._l(e.players,function(t,o){return a("div",{key:o,staticClass:"no-margin no-padding video",class:{active:o==e.playerIdx,"col-sm-12":1==e.playerLength,"col-sm-6":4==e.playerLength,"col-sm-4":9==e.playerLength,"col-sm-3":16==e.playerLength},on:{mousemove:function(a){e.resetCloseTimer(t)},touchstart:function(a){e.resetCloseTimer(t)},click:function(a){e.clickPlayer(t,o,a)},touchend:function(a){e.clickPlayer(t,o,a)}}},[a("LivePlayer",{directives:[{name:"loading",rawName:"v-loading",value:t.bLoading,expression:"player.bLoading"}],attrs:{videoUrl:t.url,waterMark:t.osd,hideBigPlayButton:!!e.serverInfo.HideBigPlayButton||e.loopPlaying,smart:t.bSmart,poster:t.poster,controls:t.bControls&&!e.loopPlaying,live:"",muted:"",stretch:"",loading:t.bLoading,"element-loading-text":"加载中...","element-loading-background":"#000"},on:{fullscreen:function(a){e.onFullscreenChange(t,o,a)},media_info:function(a){e.onMediaInfo(t,o,a)},ended:function(a){e.onEnded(t,o,a)},error:function(a){e.onError(t,o,a)},message:e.$message,"update:loading":function(a){e.$set(t,"bLoading",a)}}},[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.isMobile()&&e.hasAnyRole(e.serverInfo,e.userInfo,"管理员","操作员")&&t.bFullscreen&&t.bControls,expression:"!isMobile() && hasAnyRole(serverInfo, userInfo, '管理员', '操作员') && player.bFullscreen && player.bControls"}],staticClass:"ptz-block ptz-block-fs"},[a("div",{staticClass:"ptz-cell ptz-up",attrs:{command:"up",title:"上"},on:{mousedown:function(t){t.preventDefault(),e.ptzControl(t)}}},[a("i",{staticClass:"fa fa-chevron-up"})]),e._v(" "),a("div",{staticClass:"ptz-cell ptz-left",attrs:{command:"left",title:"左"},on:{mousedown:function(t){t.preventDefault(),e.ptzControl(t)}}},[a("i",{staticClass:"fa fa-chevron-left"})]),e._v(" "),a("div",{staticClass:"ptz-center",attrs:{title:"云台控制"}},[a("i",{staticClass:"fa fa-arrows"})]),e._v(" "),a("div",{staticClass:"ptz-cell ptz-right",attrs:{command:"right",title:"右"},on:{mousedown:function(t){t.preventDefault(),e.ptzControl(t)}}},[a("i",{staticClass:"fa fa-chevron-right"})]),e._v(" "),a("div",{staticClass:"ptz-cell ptz-down",attrs:{command:"down",title:"下"},on:{mousedown:function(t){t.preventDefault(),e.ptzControl(t)}}},[a("i",{staticClass:"fa fa-chevron-down"})]),e._v(" "),a("div",{staticClass:"ptz-cell ptz-zoomin",attrs:{command:"zoomin",title:"放大"},on:{mousedown:function(t){t.preventDefault(),e.ptzControl(t)}}},[a("i",{staticClass:"fa fa-plus-circle"})]),e._v(" "),e.canTalk()&&"标准版"!=e.serverInfo.VersionType?a("div",{staticClass:"ptz-cell ptz-talk"},[a("i",{staticClass:"fa fa-microphone",on:{mousedown:function(t){t.preventDefault(),e.talkStart(t)}}})]):e._e(),e._v(" "),a("div",{staticClass:"ptz-cell ptz-zoomout",attrs:{command:"zoomout",title:"缩小"},on:{mousedown:function(t){t.preventDefault(),e.ptzControl(t)}}},[a("i",{staticClass:"fa fa-minus-circle"})])])]),e._v(" "),e.bVideoTitle&&t.title?a("div",{staticClass:"video-title",attrs:{title:t.title}},[e._v(e._s(t.title))]):e._e(),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.url&&t.bCloseShow&&!e.loopPlaying,expression:"player.url && player.bCloseShow && !loopPlaying"}],staticClass:"video-close",on:{click:function(t){e.closeVideo(o,!0)}}},[e._v("关闭")]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.url&&t.bCloseShow&&!e.loopPlaying,expression:"!player.url && player.bCloseShow && !loopPlaying"}],staticClass:"video-close channel-selector",on:{click:function(a){e.selectChannel(o,t)}}},[e._v("选择通道")])],1)}),e._v(" "),a("ScreenChannelListDlg",{ref:"channelListFullscreenDlg",attrs:{title:e.channelListDlgTitle},on:{selected:e.play}})],2),e._v(" "),a("div",{staticClass:"clearfix"}),e._v(" "),e.isDemoUser(e.serverInfo,e.userInfo)&&e.outHevcTipIdx<0?a("div",{staticClass:"text-center"},[a("br"),e._v("\r\n            提示: 演示系统限制匿名登录播放时间, 若需测试长时间播放, 请"),a("a",{attrs:{target:"_blank",href:"//www.liveqing.com/docs/download/LiveGBS.html"}},[e._v("下载使用")])]):e._e(),e._v(" "),e.outHevcTipIdx>=0?a("div",{staticClass:"text-center text-red"},[a("br"),e._v("\r\n            提示: 正在播放 H265 直出流, 确保浏览器版本较新, 并且开启硬件加速\r\n          ")]):e._e()]),e._v(" "),e.hasAnyRole(e.serverInfo,e.userInfo,"管理员","操作员")?a("div",{staticClass:"col-md-3 col-lg-2",attrs:{id:"dev-tree-ptz"}},[a("div",{staticClass:"ptz-block"},[e.ws?a("el-progress",{staticClass:"mic-level-bar",attrs:{percentage:e.level,"text-inside":!0}}):e._e(),e._v(" "),a("div",{staticClass:"ptz-cell ptz-up",class:{readonly:!e.playing||e.loopPlaying},attrs:{command:"up",title:"上"},on:{mousedown:function(t){t.preventDefault(),e.ptzControl(t)},touchstart:function(t){t.preventDefault(),e.ptzControl(t)}}},[a("i",{staticClass:"fa fa-chevron-up"})]),e._v(" "),a("div",{staticClass:"ptz-cell ptz-left",class:{readonly:!e.playing||e.loopPlaying},attrs:{command:"left",title:"左"},on:{mousedown:function(t){t.preventDefault(),e.ptzControl(t)},touchstart:function(t){t.preventDefault(),e.ptzControl(t)}}},[a("i",{staticClass:"fa fa-chevron-left"})]),e._v(" "),a("div",{staticClass:"ptz-cell ptz-center",attrs:{title:"云台控制"}},[e.canTalk()&&"标准版"!=e.serverInfo.VersionType?a("i",{staticClass:"fa fa-microphone",class:{readonly:!e.playing||e.loopPlaying},attrs:{title:"按住喊话"},on:{mousedown:function(t){t.preventDefault(),e.talkStart(t)},touchstart:function(t){t.preventDefault(),e.talkStart(t)}}}):e._e(),e._v(" "),e.canTalk()||"标准版"==e.serverInfo.VersionType?e._e():a("i",{staticClass:"fa fa-microphone-slash",class:{readonly:!e.playing||e.loopPlaying},attrs:{title:"由于浏览器安全策略, 非 HTTPS 或 localhost 访问, 对讲不可用"}})]),e._v(" "),a("div",{staticClass:"ptz-cell ptz-right",class:{readonly:!e.playing||e.loopPlaying},attrs:{command:"right",title:"右"},on:{mousedown:function(t){t.preventDefault(),e.ptzControl(t)},touchstart:function(t){t.preventDefault(),e.ptzControl(t)}}},[a("i",{staticClass:"fa fa-chevron-right"})]),e._v(" "),a("div",{staticClass:"ptz-cell ptz-down",class:{readonly:!e.playing||e.loopPlaying},attrs:{command:"down",title:"下"},on:{mousedown:function(t){t.preventDefault(),e.ptzControl(t)},touchstart:function(t){t.preventDefault(),e.ptzControl(t)}}},[a("i",{staticClass:"fa fa-chevron-down"})]),e._v(" "),a("div",{staticClass:"ptz-cell ptz-zoomin",class:{readonly:!e.playing||e.loopPlaying},attrs:{command:"zoomin",title:"放大"},on:{mousedown:function(t){t.preventDefault(),e.ptzControl(t)},touchstart:function(t){t.preventDefault(),e.ptzControl(t)}}},[a("i",{staticClass:"fa fa-plus"})]),e._v(" "),a("div",{staticClass:"ptz-cell ptz-zoomout",class:{readonly:!e.playing||e.loopPlaying},attrs:{command:"zoomout",title:"缩小"},on:{mousedown:function(t){t.preventDefault(),e.ptzControl(t)},touchstart:function(t){t.preventDefault(),e.ptzControl(t)}}},[a("i",{staticClass:"fa fa-minus"})])],1),e._v(" "),a("div",{staticClass:"settings-block"},[a("el-checkbox",{attrs:{name:"bVideoTitle"},model:{value:e.bVideoTitle,callback:function(t){e.bVideoTitle="string"==typeof t?t.trim():t},expression:"bVideoTitle"}},[e._v("\r\n              显示名称\r\n            ")]),e._v(" "),a("br"),e._v(" "),e.playerLength>1?a("el-checkbox",{attrs:{name:"bSmartStream"},model:{value:e.bSmartStream,callback:function(t){e.bSmartStream="string"==typeof t?t.trim():t},expression:"bSmartStream"}},[e._v("\r\n              智能码流\r\n            ")]):e._e()],1)]):e._e(),e._v(" "),a("div",{staticClass:"clearfix"}),e._v(" "),a("br"),a("br",{staticClass:"hidden-xs"}),e._v(" "),a("div",{staticClass:"row hidden-xs",attrs:{id:"screen-sticky-bottom"}},[a("div",{staticClass:"text-center col-md-11 col-lg-10"},[a("el-button-group",{staticClass:"player-btn-group"},[e._l(e.playerBtnGroup,function(t){return a("el-button",{key:t.num,class:{active:e.playerLength==t.num},attrs:{type:"primary",size:"medium"},on:{click:function(a){a.preventDefault(),e.setPlayerLength(t.num)}}},[e._v(e._s(t.name))])}),e._v(" "),e.isIE()?e._e():a("el-button",{attrs:{type:"primary",size:"medium",title:e.loopPlaying?"停止轮巡播放":"选择轮巡播放通道"},on:{click:function(t){t.preventDefault(),e.loopPlaying?e.stopLoopPlay():e.showLoopPlayListDlg()}}},[e.loopPlaying?a("i",{staticClass:"fa fa-stop",staticStyle:{color:"#dd4b39"}}):a("span",[e._v("轮播")])]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"medium",title:"全屏显示"},on:{click:function(t){t.preventDefault(),e.fullscreen(t)}}},[a("i",{staticClass:"fa fa-arrows-alt"})]),e._v(" "),!e.loopPlaying&&e.hasLocalData()?a("el-button",{attrs:{type:"primary",size:"medium",title:"点击加载上次记录"},on:{click:function(t){t.preventDefault(),e.loadLocalData(!0)}}},[a("i",{staticClass:"fa fa-database"})]):e._e()],2)],1),e._v(" "),a("div",{staticClass:"clearfix"}),e._v(" "),a("br"),a("br",{staticClass:"hidden-xs"})])])])],1),e._v(" "),a("UploadDlg",{ref:"uploadDlg",attrs:{title:"上传分组列表",url:"/api/v1/channel/group/import"},on:{uploaded:e.uploaded}}),e._v(" "),a("ScreenChannelListDlg",{ref:"channelListDlg",attrs:{title:e.channelListDlgTitle},on:{selected:e.play}}),e._v(" "),a("ScreenLoopPlayListDlg",{ref:"loopPlayListDlg",on:{loopPlay:e.startLoopPlay}}),e._v(" "),a("DeviceTreeNodeEditDlg",{ref:"nodeEditDlg",on:{submit:function(t){e.treeNodeRefresh(e.pnode)}}}),e._v(" "),a("ChannelPositionEditDlg",{ref:"positionEditDlg",on:{submit:function(t){e.treeNodeRefresh(e.pnode)}}}),e._v(" "),a("DeviceTreeNodeShareDlg",{ref:"nodeShareDlg",attrs:{vtype:e.serverInfo.VersionType}}),e._v(" "),a("ChannelCustomListDlg",{ref:"customListDlg",attrs:{title:e.customListDlgTitle},on:{hide:function(t){e.treeNodeRefresh(e.pnode)}}})],1)},n=[],r={render:o,staticRenderFns:n};t.a=r},"2xaA":function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,a){function o(n,r){try{var s=t[n](r),i=s.value}catch(e){return void a(e)}if(!s.done)return Promise.resolve(i).then(function(e){o("next",e)},function(e){o("throw",e)});e(i)}return o("next")})}}Object.defineProperty(t,"__esModule",{value:!0});var r=a("A9K1"),s=o(r),i=a("0iPh"),l=o(i);t.default={data:function(){return{form:this.defForm()}},components:{FormDlg:s.default},methods:{defForm:function(){return{serial:"",code:"",name:"",custom:!1,longitude:"",latitude:"",customLongitude:"",customLatitude:""}},onHide:function(){this.form=this.defForm(),this.$emit("hide")},onShow:function(){this.errors.clear(),this.$emit("show")},onPasteLngLat:function(e){try{var t=e.clipboardData.getData("Text").trim().split(/\s*,\s*/);2==t.length&&(this.form.customLongitude=t[0],this.form.customLatitude=t[1],e.preventDefault())}catch(e){console.log(e)}},onSubmit:function(){var e=this;return n(regeneratorRuntime.mark(function t(){var a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$validator.validateAll();case 2:if(a=t.sent){t.next=8;break}return o=e.errors.items[0],e.$message({type:"error",message:o.msg}),(0,l.default)("[name="+o.field+"]").focus(),t.abrupt("return");case 8:l.default.get("/api/v1/device/setchannelposition",{serial:e.form.serial,code:e.form.code,longitude:e.form.customLongitude,latitude:e.form.customLatitude}).then(function(t){e.$refs.dlg.hide(),e.$emit("submit")});case 9:case"end":return t.stop()}},t,e)}))()},show:function(e){var t=this;this.errors.clear(),e&&(this.form.serial=e.serial,this.form.code=e.code,this.form.name=e.name,this.form.longitude=e.longitude||"",this.form.latitude=e.latitude||"",this.form.customLongitude=e.customLongitude||"",this.form.customLatitude=e.customLatitude||""),this.$nextTick(function(){t.$refs.dlg.show()})}}}},"54Qq":function(e,t,a){t=e.exports=a("FZ+f")(!1),t.push([e.i,".ptz-block .mic-level-bar .el-progress-bar__outer{background-color:#ddd!important}.view-list .video-show :not(:-webkit-full-screen) .video.active .video-inner{border:2px solid red}.view-list .video-show :not(:-moz-full-screen) .video.active .video-inner{border:2px solid red}.view-list .video-show :not(:-ms-fullscreen) .video.active .video-inner{border:2px solid red}.view-list .video-show :not(:fullscreen) .video.active .video-inner{border:2px solid red}.fullscreen>.video.col-sm-12{height:100%}.fullscreen>.video.col-sm-6{height:50%}.fullscreen>.video.col-sm-4{height:33.33%}.fullscreen>.video.col-sm-3{height:25%}.fullscreen>.video>.player-wrapper{height:100%}.fullscreen>.video>.player-wrapper .video-wrapper{padding-bottom:0!important;height:100%}",""])},"5gxX":function(e,t,a){"use strict";function o(e){a("LbQQ")}Object.defineProperty(t,"__esModule",{value:!0});var n=a("qb8i"),r=a.n(n);for(var s in n)["default","default"].indexOf(s)<0&&function(e){a.d(t,e,function(){return n[e]})}(s);var i=a("lGU5"),l=a("VU/8"),c=o,u=l(r.a,i.a,!1,c,null,null);t.default=u.exports},"5kFO":function(e,t,a){"use strict";(function(e){function o(e){return e&&e.__esModule?e:{default:e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,a){function o(n,r){try{var s=t[n](r),i=s.value}catch(e){return void a(e)}if(!s.done)return Promise.resolve(i).then(function(e){o("next",e)},function(e){o("throw",e)});e(i)}return o("next")})}}Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e};a("pFnw"),a("F8S1");var s=a("5gxX"),i=o(s),l=a("P4y8"),c=o(l),u=a("YUeX"),d=o(u),f=a("JK3F"),p=a("/aob"),h=o(p),m=a("sJmG"),v=o(m),g=a("Efkx"),y=o(g),b=a("wZh5"),w=o(b),x=a("eAMf"),_=o(x),D=a("M4fF"),C=o(D),k=a("NYxO");t.default={components:{LivePlayer:_.default,VueContextMenu:f.component,UploadDlg:i.default,ScreenChannelListDlg:c.default,DeviceTreeNodeEditDlg:h.default,ChannelPositionEditDlg:v.default,DeviceTreeNodeShareDlg:y.default,ChannelCustomListDlg:w.default,ScreenLoopPlayListDlg:d.default},data:function(){var e=this;return{q:"",players:[],playerIdx:0,playerLength:4,loadedData:!1,localData:{num1:{},num4:{},num9:{},num16:{}},channelListDlgTitle:"",protocol:"",showTree:!0,showGroupTree:!1,showTip:!1,treeLoading:!1,groupTreeLoading:!1,queryDevTreeLoading:!1,queryGroupTreeLoading:!1,defExpandDevs:[],defExpandGroups:[],devLevelFilter:!1,groupLevelFilter:!1,fullscreenFlag:!1,pnode:null,contextMenuTarget:null,contextMenuVisible:!1,contextMenuNodeData:null,treeProps:{label:function(t,a){a.serial=t.serial,a.code=t.code;var o=t.customName||t.name||t.code||t.id;return!t.custom||t.code||e.hasAllChannel(e.serverInfo,e.userInfo)?(!e.treeLeaf(t)&&t.subCountDevice>0&&(o+=" ["+t.onlineSubCount+"/"+t.subCountDevice+"]"),o):o},isLeaf:function(t,a){return e.treeLeaf(t)},disabled:function(t,a){return e.treeLeaf(t)&&"ON"!=t.status}},customListDlgTitle:"选择通道",bSmartStream:!1,bVideoTitle:!1,recorder:null,ws:null,level:0,loopChannelIndex:0,loopPlayerIndex:0,loopPlaying:!1,loopChannels:[],loopInterval:10,loopTimer:0,bPlayerFullscreen:!1,outHevcTipIdx:-1,queryDevTreeDataList:[],queryGroupTreeDataList:[],activeTab:"dev"}},computed:r({},(0,k.mapState)(["userInfo","serverInfo"]),{playerBtnGroup:function(){var e=[{num:1,name:"单屏"},{num:4,name:"四分屏"},{num:9,name:"九分屏"}];return this.isIE()||this.isMobile()||e.push({num:16,name:"十六分屏"}),e},playing:function(){return!!(this.players[this.playerIdx]||{}).url},canPTZ:function(){var e=this.players[this.playerIdx]||{};return!!e.url&&(0===e.ptzType||1===e.ptzType)},treeEmptyText:function(){return this.treeLoading?"加载中...":"暂无数据"},groupTreeEmptyText:function(){return this.groupTreeLoading?"加载中...":"暂无数据"},queryDevTreeEmptyText:function(){return this.queryDevTreeLoading?"搜索中...":"暂无搜索结果"},queryGroupTreeEmptyText:function(){return this.queryGroupTreeLoading?"搜索中...":"暂无搜索结果"},showQueryDevTree:function(){return!!this.q&&(!("dev"!=this.activeTab||!this.devLevelFilter)&&(this.queryDevTreeLoading=!0,!0))},showQueryGroupTree:function(){return!!this.q&&(!("group"!=this.activeTab||!this.groupLevelFilter)&&(this.queryGroupTreeLoading=!0,!0))}}),mounted:function(){var t=this;this.isMobile()&&(this.playerLength=1),this.setPlayerLength(this.playerLength),this.protocol=this.getQueryString("protocol",this.serverInfo.PreferStreamFmt||""),this.loadLocalData(!1),this.contextMenuTarget=document.querySelector("#tab-tree-wrapper"),e(document).on("mouseup touchend",this.mouseUp),e(document).on("expanded.pushMenu collapsed.pushMenu",this.updateSticky),e("#screen-sticky").sticky({bottomSpacing:40}),e('a[href="#group-tree-wrapper"').on("shown.bs.tab",function(e){setTimeout(function(){t.showTip=!0},100)}).on("hidden.bs.tab",function(e){t.showTip=!1})},beforeDestroy:function(){this.ctrlStop(),e('a[href="#group-tree-wrapper"').off("shown.bs.tab").off("hidden.bs.tab"),e(document).off("mouseup touchend",this.mouseUp),e(document).off("expanded.pushMenu collapsed.pushMenu",this.updateSticky),this.clearVideos(),e("#screen-sticky").unstick()},beforeRouteEnter:function(e,t,a){a(function(t){e.query.protocol&&(t.protocol=e.query.protocol)})},beforeRouteUpdate:function(e,t,a){this.clearVideos(),e.query.protocol&&(this.protocol=e.query.protocol),a()},beforeRouteLeave:function(e,t,a){this.clearVideos(),a()},watch:{q:function(e,t){if(!e)return void this.treeRefresh();this.showQueryDevTree?this.doDelayQueryDevSearch():this.showQueryGroupTree?this.doDelayQueryGroupSearch():this.doDelaySearch()},bSmartStream:function(e,t){var a=this;for(var o in this.players){(function(t){var o=a.players[t];if(!o)return"continue";var n=o.url;if(!n)return"continue";o.url="",o.bSmart=e,a.$nextTick(function(){o.url=n})})(o)}}},methods:{doDelaySearch:C.default.debounce(function(){"dev"!=this.activeTab||this.devLevelFilter||this.$refs.devTree.filter(this.q),"group"!=this.activeTab||this.groupLevelFilter||this.$refs.groupTree.filter(this.q)},800),doDelayQueryDevSearch:C.default.debounce(function(){this.queryDevTreeData()},800),doDelayQueryGroupSearch:C.default.debounce(function(){this.queryGroupTreeData()},800),hasLocalData:function(){if(localStorage.livegbs_screen){for(var e=0;e<this.playerLength;e++)if(this.localData["num"+this.playerLength]["c"+e])return!this.loadedData;this.loadedData=!0}return!1},setLocalData:function(){this.loadedData=!0,localStorage.livegbs_screen=JSON.stringify(this.localData)},loadLocalData:function(e){if(localStorage.livegbs_screen&&(this.localData=JSON.parse(localStorage.livegbs_screen)),e){if(this.isDemoUser(this.serverInfo,this.userInfo)&&this.playerLength>4)return void this.$message({type:"error",message:"演示系统请在四分屏体验, 或下载使用"});this.loadedData=!0;for(var t=0;t<this.playerLength;t++)if(this.localData["num"+this.playerLength]["c"+t]){var a=JSON.parse(this.localData["num"+this.playerLength]["c"+t]);this.play(t,a,!1)}}},getQueryString:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),o=window.location.search.substr(1).match(a);return null!=o?unescape(o[2]):t},clearVideos:function(){this.loopTimer&&(clearTimeout(this.loopTimer),this.loopTimer=0),this.loopChannelIndex=0,this.loopPlayerIndex=0,this.loopPlaying=!1,this.loopChannels=[],this.loopInterval=10,this.outHevcTipIdx=-1;for(var e in this.players)this.closeVideo(e)},selectChannel:function(e){this.showTip=!1,this.channelListDlgTitle="为第 "+(e+1)+" 屏选择通道",this.fullscreenFlag?this.$refs.channelListFullscreenDlg.show(e):this.$refs.channelListDlg.show(e)},play:function(t,a,o){var n=this,r=0,s=null,i=!0,l=!1,c=void 0;try{for(var u,d=this.players[Symbol.iterator]();!(i=(u=d.next()).done);i=!0){var f=u.value;if(t==r){s=f;break}r++}}catch(e){l=!0,c=e}finally{try{!i&&d.return&&d.return()}finally{if(l)throw c}}if(!s)return void this.$message({type:"error",message:"当前播放窗口已被占满！"});s.bLoading||(s.bLoading=!0,o&&this.setPlayerIdx(t+1),a.Node&&(s.node=a.Node,this.$set(s.node,"playing",!0),delete a.Node),e.get("/api/v1/stream/start",{serial:a.DeviceID,code:a.ID}).then(function(e){var o=e.HLS,r="HLS";switch(n.flvSupported()&&(e.FLV&&n.players.length<6&&!n.isIE()?(o=e.FLV,r="FLV"):e.WS_FLV&&(o=e.WS_FLV,r="WS_FLV")),String(n.protocol).toUpperCase()){case"WEBRTC":n.rtcSupported()&&(o=e.WEBRTC||"",r="WEBRTC");break;case"RTMP":o=e.RTMP||"",r="RTMP";break;case"HLS":o=e.HLS||"",r="HLS";break;case"FLV":if(n.players.length<6&&n.flvSupported()&&!n.isIE()){o=e.FLV||"",r="FLV";break}case"WS_FLV":case"WS-FLV":n.flvSupported()&&(o=e.WS_FLV||"",r="WS_FLV")}if(s.serial=a.DeviceID,s.code=a.ID,s.ptzType=a.PTZType,s.protocol=r,s.poster="RTMP"==r?"":e.SnapURL,s.title=a.CustomName||a.Name||e.ChannelName||a.ID||"",s.osd=e.ChannelOSD||"",s.bSmart=n.playerLength>1&&n.bSmartStream,s.url=o,s.node){n.$delete(s.node,"playing");var i=s.node.play||[];o&&i.push(t),i.length&&n.$set(s.node,"play",i)}n.resetCloseTimer(s),n.loadedData||(n.localData["num"+n.playerLength]={}),n.localData["num"+n.playerLength]["c"+t]=JSON.stringify(a),n.setLocalData()}).fail(function(){n.$nextTick(function(){s.bLoading=!1,s.node&&n.$delete(s.node,"playing")})}))},closeVideo:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=this.players[e];if(a){if(a.closeTimer&&(clearTimeout(a.closeTimer),a.closeTimer=0),this.outHevcTipIdx==e&&(this.outHevcTipIdx=-1),a.node){var o=a.node.play||[];o=o.filter(function(t){return t!=e}),o.length?this.$set(a.node,"play",o):(this.$delete(a.node,"play"),this.$delete(a.node,"playing")),delete a.node}a.mediaInfo=null,a.bCloseShow=!1,a.bControls=!1,a.bLoading=!1,a.bSmart=!1,a.bFullscreen=!1,a.poster="",a.protocol="",a.title="",a.osd="",a.url="",a.ptzType=0,a.serial="",a.code="",t&&(delete this.localData["num"+this.playerLength]["c"+e],this.setLocalData())}},setPlayerLength:function(e){if(e!=this.players.length){this.ctrlStop(),this.clearVideos(),this.players=[],this.playerLength=e,this.loadedData=!1,this.playerIdx=0;for(var t=0;t<e;t++)this.players.push({serial:"",code:"",url:"",ptzType:0,protocol:"",poster:"",title:"",osd:"",bLoading:!1,bCloseShow:!1,bControls:!1,bSmart:!1,bFullscreen:!1,closeTimer:0,closeInterval:0,mediaInfo:null})}},setPlayerIdx:function(e){var t=e%this.players.length;t!=this.playerIdx&&this.ctrlStop(),this.playerIdx=t},clickPlayer:function(t,a,o){e(o.target).hasClass("video-close")||this.setPlayerIdx(a)},onMediaInfo:function(e,t,a){e.mediaInfo=a},onEnded:function(e,t,a){e.mediaInfo=null},onError:function(e,t,a){"MediaError"==a&&(e.mediaInfo&&String(e.mediaInfo.videoCodec).startsWith("hvc")||"HLS"==e.protocol)&&(this.outHevcTipIdx=t,console.log("提示: 正在播放 H265 直出流, 确保浏览器版本较新, 并且开启硬件加速"))},onFullscreenChange:function(t,a,o){t&&(t.bFullscreen=o,this.bPlayerFullscreen=o,o?e("#dev-tree-right .video-show .video:eq("+a+") .ptz-block-fs").draggable({handle:".ptz-center",cancel:".ptz-cell",containment:"#dev-tree-right .video-show .video:eq("+a+") .video-js",delay:100}):e("#dev-tree-right .video-show .video:eq("+a+") .ptz-block-fs").draggable("destroy"))},fullscreen:function(){var e=this;this.$fullscreen.enter(this.$el.querySelector(".video-show > div"),{wrap:!1,callback:function(t){e.fullscreenFlag=t}})},resetCloseTimer:function(t){var a=this;t.bCloseShow=!0,t.bControls=!0,t.closeTimer&&clearTimeout(t.closeTimer),t.closeTimer=setTimeout(function(){t.bCloseShow=!1,t.closeInterval=0,0==e(a.$el).find(".ptz-cell.active").length&&0==e(a.$el).find(".fa-microphone.active").length&&(t.bControls=!1)},t.closeInterval||2e3)},treeLoad:function(t,a){var o=this,n=(t.data||{}).serial||"",r=(t.data||{}).code||"";this.treeLoading=!0,e.get("/api/v1/device/channeltree",{serial:n,pcode:r}).then(function(e){a((e||[]).map(function(e,a,n){return t.level||o.devLevelFilter||(n.length>100?o.devLevelFilter=!0:e.subCount>1e3&&(o.devLevelFilter=!0)),Object.assign(e,{key:e.id})})),o.q&&!t.matched&&o.$refs.devTree.filter(o.q)}).always(function(){o.$nextTick(function(){o.treeLoading=!1}),o.q&&!o.q.endsWith(" ")&&o.q.split(/\s+/).length===t.level&&o.devLevelFilter&&(o.q+=" ",o.$refs.q.focus())})},queryDevTreeData:function(){var t=this;this.queryDevTreeLoading=!0,this.queryDevTreeDataList=[],e.get("/api/v1/device/channellist",{q:this.q,start:0,limit:50,channel_type:"list"}).then(function(e){t.queryDevTreeDataList=(e||[]).map(function(e,t,a){return Object.assign(e,{key:e.id})})}).always(function(){t.$nextTick(function(){t.queryDevTreeLoading=!1})})},queryGroupTreeData:function(){var t=this;this.queryGroupTreeLoading=!0,this.queryGroupTreeDataList=[],e.get("/api/v1/device/channellist",{q:this.q,start:0,limit:50,channel_type:"list",custom:!0}).then(function(e){t.queryGroupTreeDataList=(e||[]).map(function(e,t,a){return Object.assign(e,{key:e.id})})}).always(function(){t.$nextTick(function(){t.queryGroupTreeLoading=!1})})},queryDevTreeLoad:function(t,a){var o=this,n=(t.data||{}).serial||"",r=(t.data||{}).code||"";(n||r)&&(this.queryDevTreeLoading=!0,e.get("/api/v1/device/channeltree",{serial:n,pcode:r}).then(function(e){a((e||[]).map(function(e,t,a){return Object.assign(e,{key:e.id})}))}).always(function(){o.$nextTick(function(){o.queryDevTreeLoading=!1})}))},queryGroupTreeLoad:function(t,a){var o=this,n=(t.data||{}).serial||"",r=(t.data||{}).code||"";(n||r)&&(this.queryGroupTreeLoading=!0,e.get("/api/v1/device/grouptree",{serial:n,pcode:r}).then(function(e){a((e||[]).map(function(e,t,a){return Object.assign(e,{key:e.id})}))}).always(function(){o.$nextTick(function(){o.queryGroupTreeLoading=!1})}))},groupTreeLoad:function(t,a){var o=this,n=(t.data||{}).serial||"",r=(t.data||{}).code||"";this.groupTreeLoading=!0,e.get("/api/v1/device/grouptree",{serial:n,pcode:r}).then(function(e){a((e||[]).map(function(e,a,n){return!t.level&&e.id&&o.defExpandGroups.indexOf(e.id)<0&&o.defExpandGroups.push(e.id),t.level||o.groupLevelFilter||(n.length>100?o.groupLevelFilter=!0:e.subCount>1e3&&(o.groupLevelFilter=!0)),Object.assign(e,{key:e.id})})),o.q&&!t.matched&&o.$refs.groupTree.filter(o.q)}).always(function(){o.$nextTick(function(){o.groupTreeLoading=!1}),o.q&&!o.q.endsWith(" ")&&o.q.split(/\s+/).length===t.level-1&&o.groupLevelFilter&&(o.q+=" ",o.$refs.q.focus())})},devTreeFilter:function(e,t,a){if(!e)return!0;if(this.devLevelFilter){var o=e.trim().split(/\s+/);if(a.level<=0||a.level>o.length)return!0;var n=o[a.level-1];return!n||!t||((t.name||"")+" "+(t.customName||"")+" "+(t.id||"")).indexOf(n)>=0}var n=e.trim();return!n||(a.parent&&a.parent.matched?(a.matched=!0,a.matched):(a.matched=((t.name||"")+" "+(t.customName||"")+" "+(t.id||"")).indexOf(n)>=0,!a.matched&&!a.isLeaf&&a.expand(),a.matched))},groupTreeFilter:function(e,t,a){if(!e)return!0;if(this.groupLevelFilter){var o=e.trim().split(/\s+/);if(a.level-1<=0||a.level-1>o.length)return!0;var n=o[a.level-2];return!n||!t||((t.name||"")+" "+(t.customName||"")+" "+(t.id||"")).indexOf(n)>=0}var n=e.trim();return!n||(a.parent&&a.parent.matched?(a.matched=!0,a.matched):(a.matched=((t.name||"")+" "+(t.customName||"")+" "+(t.id||"")).indexOf(n)>=0,!a.matched&&!a.isLeaf&&a.expand(),a.matched))},treeNodeRefresh:function(e){if(!e||!e.level)return void this.treeRefresh();this.contextMenuVisible=!1,e.loaded=!1,e.expand()},treeNodeRightClick:function(e,t,a,o){this.showTip=!1,this.contextMenuNodeData=t,this.contextMenuNode=a,this.pnode=a.parent;var n;"function"==typeof MouseEvent?n=new MouseEvent(e.type,e):(n=document.createEvent("MouseEvents"),n.initMouseEvent(e.type,!0,!0,e.view,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e)),this.contextMenuTarget.dispatchEvent(n)},treeNodeClick:function(e,t,a){var o=this;if(this.contextMenuNodeData=null,this.contextMenuNode=null,this.treeLeaf(e)&&t&&!t.playing&&(t.timer&&clearTimeout(t.timer),!t.clickCnt||t.clickCnt>1?t.clickCnt=1:t.clickCnt++,t.timer=setTimeout(function(){t.clickCnt=0,t.timer=0},500),"ON"===e.status||2==t.clickCnt)){if((this.players[this.playerIdx]||{}).bLoading)return;this.closeVideo(this.playerIdx),this.$nextTick(function(){o.play(o.playerIdx,{DeviceID:e.serial,ID:e.code,PTZType:e.ptzType,Name:t.label,Node:t},!0)})}},showNodeEditDlg:function(){if(this.showTip=!1,this.contextMenuVisible=!1,this.contextMenuNodeData){var e=Object.assign({},this.contextMenuNodeData,{parent:this.getParentData(),add:!1});this.$refs.nodeEditDlg.show(e)}},showPositionEditDlg:function(){var t=this;this.showTip=!1,this.contextMenuVisible=!1,this.contextMenuNodeData&&e.get("/api/v1/device/channelinfo",{serial:this.contextMenuNodeData.serial,code:this.contextMenuNodeData.code}).then(function(e){t.$refs.positionEditDlg.show({serial:e.DeviceID,code:e.ID,name:e.CustomName||e.Name,custom:e.Custom,longitude:e.Longitude,latitude:e.Latitude,customLongitude:e.CustomLongitude,customLatitude:e.CustomLatitude})})},showNodeShareDlg:function(){if(this.showTip=!1,this.contextMenuVisible=!1,this.contextMenuNodeData){var e=Object.assign({},this.contextMenuNodeData,{devtree:"dev"==this.activeTab});this.$refs.nodeShareDlg.show(e)}},showNodeAddDlg:function(){if(this.showTip=!1,this.contextMenuVisible=!1,this.contextMenuNodeData){var e=Object.assign({serial:this.contextMenuNodeData.serial||"",code:"",name:"",customName:"",custom:this.contextMenuNodeData.custom},{parent:this.contextMenuNodeData,add:!0});this.$refs.nodeEditDlg.show(e)}},exportGroup:function(){this.contextMenuVisible=!1,window.open("/api/v1/channel/group/export")},importGroup:function(){this.contextMenuVisible=!1,this.$refs.uploadDlg.show()},uploaded:function(){this.$message({type:"success",message:"上传成功！"}),this.treeRefresh(),this.$refs.uploadDlg.hide()},showNodeImportDlg:function(){if(this.showTip=!1,this.contextMenuVisible=!1,this.contextMenuNodeData){var e=Object.assign({serial:this.contextMenuNodeData.serial||"",code:"",name:"",customName:""},{parent:this.contextMenuNodeData,add:!0,import:!0});this.$refs.nodeEditDlg.show(e)}},showCustomListDlg:function(){this.showTip=!1,this.contextMenuVisible=!1,this.contextMenuNodeData&&(this.customListDlgTitle="选择通道("+(this.contextMenuNodeData.customName||this.contextMenuNodeData.name||this.contextMenuNodeData.code)+")",this.$refs.customListDlg.show(this.contextMenuNodeData.code))},removeCustomNode:function(){var t=this;if(this.showTip=!1,this.contextMenuVisible=!1,this.contextMenuNodeData){var a=this.contextMenuNodeData.customName||this.contextMenuNodeData.name||this.contextMenuNodeData.id,o=this.contextMenuNodeData.custom?"删除":"移出";this.$confirm("确认"+o+" "+a+" ?","提示").then(function(){e.get("/api/v1/channel/remove",{serial:t.contextMenuNodeData.serial,code:t.contextMenuNodeData.code}).always(function(){if(!t.contextMenuNodeData.custom&&t.pnode)return t.treeNodeRefresh(t.pnode.parent),void(t.contextMenuNodeData=null);t.treeNodeRefresh(t.pnode),t.contextMenuNodeData=null})}).catch(function(){})}},removeVirtualNode:function(){var t=this;if(this.showTip=!1,this.contextMenuVisible=!1,this.contextMenuNodeData){var a=this.contextMenuNodeData.customName||this.contextMenuNodeData.name||this.contextMenuNodeData.id;this.$confirm("确认删除虚拟通道 "+a+" ?","提示").then(function(){e.get("/api/v1/channel/virtual/remove",{serial:t.contextMenuNodeData.serial,code:t.contextMenuNodeData.code}).always(function(){t.treeNodeRefresh(t.pnode),t.contextMenuNodeData=null})}).catch(function(){})}},treeRefresh:function(){var e=this;this.showTip=!1,this.contextMenuVisible=!1,this.showQueryDevTree?this.queryDevTreeData():this.showQueryGroupTree?this.queryGroupTreeData():"dev"==this.activeTab?(this.showTree=!1,this.$nextTick(function(){e.showTree=!0})):"group"==this.activeTab&&(this.showGroupTree=!1,this.$nextTick(function(){e.showGroupTree=!0}))},treeLeaf:function(e){if(e&&0==e.subCount&&e.serial&&e.code&&!e.custom){if(this.serverInfo.StrictChannelParental&&e.parental)return!1;if(this.serverInfo.StrictChannelCode&&20!=e.code.length)return!1;if((!e.parental||"LiveQing"!=e.manufacturer)&&(20!=e.code.length||"216"!=e.code.substring(10,13)&&"215"!=e.code.substring(10,13)))return!0}return!1},getParentData:function(){if(!this.contextMenuNodeData)return null;var e="devTree";if("group"==this.activeTab&&(e="groupTree"),this.showQueryDevTree&&(e="queryDevTree"),this.showQueryGroupTree&&(e="queryGroupTree"),!this.$refs[e])return null;var t=this.$refs[e].getNode(this.contextMenuNodeData);return t&&t.parent?t.parent.data:null},ptzControl:function(t){var a=this.players[this.playerIdx];if(a&&a.serial&&a.code){var o=e(t.currentTarget),n=o.attr("command");e.ajax({method:"GET",url:"/api/v1/control/ptz",global:!1,data:{serial:a.serial,code:a.code,command:n}}).fail(function(e){e&&(console.log("ptz "+n+" ajax error: "+e.status+" "+e.responseText),401==e.status&&(location.href="/login?r="+encodeURIComponent(window.location.href)))}),o.addClass("active")}},ptzStop:function(){var t=this,a=this.players[this.playerIdx];a&&a.serial&&a.code&&e(this.$el).find(".ptz-cell.active").length>0&&(e.ajax({method:"GET",url:"/api/v1/control/ptz",global:!1,data:{serial:a.serial,code:a.code,command:"stop"}}).fail(function(e){e&&(console.log("ptz stop ajax error: "+e.status+" "+e.responseText),401==e.status&&(location.href="/login?r="+encodeURIComponent(window.location.href)))}).always(function(){!t.isMobile()&&a.bFullscreen&&a.bControls&&(a.closeInterval=5e3,t.resetCloseTimer(a))}),e(this.$el).find(".ptz-cell.active").removeClass("active"))},talkStart:function(t){var a=this;if(this.ws){if(this.serverInfo.TalkHold)return void this.talkStop()}else{var o=this.wsTalkURL();if(!o)return;this.ws=new WebSocket(o),this.ws.onopen=function(e){console.log("ws talk open")},this.ws.onclose=function(e){console.log("ws talk close")},this.ws.onerror=function(e){console.log("ws talk error",e)}}var n=e(t.currentTarget);if(this.recorder)return n.addClass("active"),void this.recorder.start();LiveRecorder.get(function(e,t){if(t)return alert(t),void a.talkStop();n.addClass("active"),a.recorder=e,a.recorder.start()},{sampleBits:16,sampleRate:8e3,pcmCallback:function(e,t){var o=new window.FileReader;o.onloadend=function(){var e=o.result,e=e.split(",")[1];a.ws&&a.ws.readyState===WebSocket.OPEN&&(a.ws.send(e),a.level=t)},o.readAsDataURL(e)}})},talkStop:function(){this.recorder&&(this.recorder.destroy(),this.recorder=null,e(this.$el).find(".fa-microphone.active").removeClass("active")),this.ws&&(this.ws.close(),this.ws=null),this.level=0},ctrlStop:function(){this.talkStop(),this.ptzStop()},mouseUp:function(){this.serverInfo.TalkHold||this.talkStop(),this.ptzStop()},wsTalkURL:function(){var e=this.players[this.playerIdx];if(!e||!e.serial||!e.code)return"";var t="ws:";return location.protocol.startsWith("https")&&(t="wss:"),t+"//"+location.host+"/api/v1/control/ws-talk/"+e.serial+"/"+e.code+"?format=pcm"},updateSticky:function(){e("#screen-sticky").sticky("update"),this.$nextTick(function(){e("#screen-sticky").sticky("update")})},startLoopPlay:function(e,t){if(this.clearVideos(),this.isDemoUser(this.serverInfo,this.userInfo)&&this.playerLength>4)return void this.$message({type:"error",message:"演示系统请在四分屏体验, 或下载使用"});this.loopChannelIndex=0,this.loopPlayerIndex=0,this.loopPlaying=!0,this.loopChannels=e,this.loopInterval=t,this.loopPlay()},stopLoopPlay:function(){this.clearVideos()},loopPlay:function(){var e=this;return n(regeneratorRuntime.mark(function t(){var a,o,n,r,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.loopPlaying){t.next=2;break}return t.abrupt("return");case 2:if(e.loopChannels&&e.loopChannels.length){t.next=5;break}return e.$message({type:"error",message:"没有可轮播资源"}),t.abrupt("return");case 5:if(a=e.loopChannelIndex%e.loopChannels.length,!(0==(o=e.loopPlayerIndex%e.players.length)&&e.loopPlayerIndex>0)){t.next=12;break}if(e.loopPlayerIndex=0,!(a>0||0==e.loopChannelIndex)){t.next=12;break}return e.loopTimer=setTimeout(function(){e.loopPlay()},1e3*e.loopInterval),t.abrupt("return");case 12:if(!(0==a&&e.loopChannelIndex>0&&0==e.loopPlayerIndex)){t.next=16;break}return e.loopChannelIndex=0,e.loopTimer=setTimeout(function(){e.loopPlay()},1e3*e.loopInterval),t.abrupt("return");case 16:if(!e.bPlayerFullscreen){t.next=19;break}return e.loopTimer=setTimeout(function(){e.loopPlay()},1e3*e.loopInterval),t.abrupt("return");case 19:if(n=e.loopChannels[a],(r=e.players[o])&&!r.bFullscreen){t.next=25;break}return e.loopPlayerIndex++,e.loopPlay(),t.abrupt("return");case 25:return t.next=27,e.loopPlayChannel(n,r);case 27:s=t.sent,s?(e.loopChannelIndex++,e.loopPlayerIndex++):e.loopChannelIndex++,e.loopPlay();case 30:case"end":return t.stop()}},t,e)}))()},loopPlayChannel:function(e,t){var a=this;return n(regeneratorRuntime.mark(function o(){var n,r,s;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(a.loopPlaying){o.next=2;break}return o.abrupt("return",!1);case 2:if(e){o.next=4;break}return o.abrupt("return",!1);case 4:return o.next=6,a.loopStreamStart(e);case 6:if(n=o.sent){o.next=9;break}return o.abrupt("return",!1);case 9:if(!t){o.next=39;break}r=n.HLS,s="HLS",a.flvSupported()&&(n.FLV&&a.players.length<6&&!a.isIE()?(r=n.FLV,s="FLV"):n.WS_FLV&&(r=n.WS_FLV,s="WS_FLV")),o.t0=String(a.protocol).toUpperCase(),o.next="WEBRTC"===o.t0?16:"RTMP"===o.t0?18:"HLS"===o.t0?21:"FLV"===o.t0?24:"WS_FLV"===o.t0?28:"WS-FLV"===o.t0?28:30;break;case 16:return a.rtcSupported()&&(r=n.WEBRTC||"",s="WEBRTC"),o.abrupt("break",30);case 18:return r=n.RTMP||"",s="RTMP",o.abrupt("break",30);case 21:return r=n.HLS||"",s="HLS",o.abrupt("break",30);case 24:if(!(a.players.length<6&&a.flvSupported())||a.isIE()){o.next=28;break}return r=n.FLV||"",s="FLV",o.abrupt("break",30);case 28:return a.flvSupported()&&(r=n.WS_FLV||"",s="WS_FLV"),o.abrupt("break",30);case 30:t.serial=e.DeviceID,t.code=e.ID,t.ptzType=e.PTZType,t.protocol=s,t.poster="RTMP"==s?"":n.SnapURL,t.title=e.CustomName||e.Name||n.ChannelName||e.ID||"",t.osd=n.ChannelOSD||"",t.bSmart=a.playerLength>1&&a.bSmartStream,t.url=r;case 39:return o.abrupt("return",!0);case 40:case"end":return o.stop()}},o,a)}))()},loopStreamStart:function(t){var a=this;return new Promise(function(o,n){var r={serial:t.DeviceID,code:t.ID};e.ajax({method:"GET",url:"/api/v1/stream/start",global:!1,data:r}).then(function(e){if(!a.loopPlaying)return void o(null);o(e)}).fail(function(e){e&&(console.log("stream start in loop play error: "+e.status+" "+e.responseText),401==e.status&&a.$nextTick(function(){location.href="/login?r="+encodeURIComponent(window.location.href)})),o(null)})})},showLoopPlayListDlg:function(){this.showTip=!1,this.$refs.loopPlayListDlg.show()},switchTab:function(e){var t=this;"group"!=e||this.showGroupTree||(this.showGroupTree=!0),this.activeTab!=e&&(this.q="",this.$nextTick(function(){t.activeTab=e}))},allowDrag:function(e){return!(e.level<2)&&(!(!e.data||!e.data.code)&&(!(!e.parent||!e.parent.data)&&(!(!e.data.custom&&!e.parent.data.custom)&&(this.pnode=e.parent,!0))))},allowDrop:function(e,t,a){return!(e.level<2)&&(!(t.level<1)&&(!!(e.parent&&e.data&&e.data.code)&&(!(!t.data||!t.data.custom)&&(!(!e.data.custom&&!t.data.code)&&(!(!t.data.code&&!this.hasAnyRole(this.serverInfo,this.userInfo,"超级管理员"))&&"inner"==a)))))},handleDrop:function(t,a,o,n){var r=this;"inner"==o&&e.get("/api/v1/channel/move",{serial:t.data.serial,code:t.data.code,pcode:a.data.code}).always(function(){return(!r.pnode||r.pnode.parent&&r.pnode.parent.level)&&a.parent&&a.parent.level?(r.treeNodeRefresh(a.parent),void(r.pnode&&a.parent!=r.pnode.parent&&r.treeNodeRefresh(r.pnode.parent))):void r.treeRefresh()})},playStop:function(e){if(this.contextMenuVisible=!1,e&&e.play&&e.play.length){var t=!0,a=!1,o=void 0;try{for(var n,r=e.play[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){var s=n.value;this.closeVideo(s,!0)}}catch(e){a=!0,o=e}finally{try{!t&&r.return&&r.return()}finally{if(a)throw o}}}}}}}).call(t,a("0iPh"))},ACB8:function(e,t,a){"use strict";function o(e){a("lVCW"),a("NTHK"),a("Lc/B")}Object.defineProperty(t,"__esModule",{value:!0});var n=a("5kFO"),r=a.n(n);for(var s in n)["default","default"].indexOf(s)<0&&function(e){a.d(t,e,function(){return n[e]})}(s);var i=a("04UO"),l=a("VU/8"),c=o,u=l(r.a,i.a,!1,c,"data-v-ec71958a",null);t.default=u.exports},ALqx:function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("FormDlg",{ref:"dlg",attrs:{title:e.title,disabled:e.errors.any()},on:{hide:e.onHide,show:e.onShow,submit:e.onSubmit}},[a("div",{class:{"form-group":!0,"has-error":e.errors.has("serial")}},[a("label",{staticClass:"col-sm-4 control-label",attrs:{for:"share-node-serial"}},[e._v("设备编号\n        ")]),e._v(" "),a("div",{staticClass:"col-sm-7"},[a("input",{staticClass:"form-control",attrs:{type:"text",readonly:"readonly",id:"share-node-serial",name:"serial","data-vv-as":"设备编号"},domProps:{value:e.form.serial}})])]),e._v(" "),a("div",{class:{"form-group":!0,"has-error":e.errors.has("code")}},[a("label",{staticClass:"col-sm-4 control-label",attrs:{for:"share-node-code"}},[e._v("节点编号\n        ")]),e._v(" "),a("div",{staticClass:"col-sm-7"},[a("input",{staticClass:"form-control",attrs:{type:"text",readonly:"readonly",id:"share-node-code",name:"code","data-vv-as":"通道编号"},domProps:{value:e.form.code}})])]),e._v(" "),a("div",{class:{"form-group":!0,"has-error":e.errors.has("name")}},[a("label",{staticClass:"col-sm-4 control-label",attrs:{for:"share-node-name"}},[e._v("节点名称\n        ")]),e._v(" "),a("div",{staticClass:"col-sm-7"},[a("input",{staticClass:"form-control",attrs:{type:"text",readonly:"readonly",id:"share-node-name",name:"name","data-vv-as":"节点名称"},domProps:{value:e.form.name}})])]),e._v(" "),a("div",{class:{"form-group":!0,"has-error":e.errors.has("target")}},[a("label",{staticClass:"col-sm-4 control-label"},[e._v("共享给\n        ")]),e._v(" "),a("div",{staticClass:"col-sm-7 checkbox"},[a("el-radio",{directives:[{name:"show",rawName:"v-show",value:"标准版"!=e.vtype,expression:"vtype != '标准版'"}],staticStyle:{"margin-left":"-19px","margin-top":"-5px"},attrs:{size:"small",label:"cascade"},on:{change:e.changeTarget},model:{value:e.form.target,callback:function(t){e.$set(e.form,"target",t)},expression:"form.target"}},[e._v("上级平台    ")]),e._v(" "),a("el-radio",{staticStyle:{"margin-left":"-19px","margin-top":"-5px"},attrs:{size:"small",label:"user"},on:{change:e.changeTarget},model:{value:e.form.target,callback:function(t){e.$set(e.form,"target",t)},expression:"form.target"}},[e._v("用 户")])],1)]),e._v(" "),"cascade"==e.form.target?a("div",{class:{"form-group":!0,"has-error":e.errors.has("cascade_id")}},[a("label",{staticClass:"col-sm-4 control-label",attrs:{for:"share-node-cascade-id"}},[e._v("上级平台\n            "),a("span",{staticClass:"text-red"},[e._v("*")])]),e._v(" "),a("div",{staticClass:"col-sm-7"},[a("el-select",{ref:"selectCascade",staticStyle:{width:"100%"},attrs:{filterable:"",clearable:"",remote:"","remote-method":e.loadCascade,loading:e.bLoading,id:"share-node-cascade-id",name:"cascade_id",placeholder:"搜索",size:"small"},on:{change:e.changeCascade,clear:e.clearCascade},model:{value:e.form.cascade_id,callback:function(t){e.$set(e.form,"cascade_id",t)},expression:"form.cascade_id"}},e._l(e.cascades,function(t){return a("el-option",{key:t.ID,attrs:{label:e.renderCascadeName(t),value:t.ID}})}))],1)]):e._e(),e._v(" "),"user"==e.form.target?a("div",{class:{"form-group":!0,"has-error":e.errors.has("username")}},[a("label",{staticClass:"col-sm-4 control-label",attrs:{for:"share-node-username"}},[e._v("用 户\n            "),a("span",{staticClass:"text-red"},[e._v("*")])]),e._v(" "),a("div",{staticClass:"col-sm-7"},[a("el-select",{ref:"selectUser",staticStyle:{width:"100%"},attrs:{filterable:"",clearable:"",remote:"","remote-method":e.loadUser,loading:e.bLoading,id:"share-node-username",name:"username",placeholder:"搜索",size:"small"},on:{change:e.changeUser,clear:e.clearUser},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}},e._l(e.users,function(t){return a("el-option",{key:t.Username,attrs:{label:e.renderUsername(t),value:t.Username}})}))],1)]):e._e(),e._v(" "),a("div",{class:{"form-group":!0,"has-error":e.errors.has("share")}},[a("label",{staticClass:"col-sm-4 control-label"},[e._v("操作类型\n        ")]),e._v(" "),a("div",{staticClass:"col-sm-7 checkbox"},[a("el-radio",{staticStyle:{"margin-left":"-19px","margin-top":"-5px"},attrs:{size:"small",label:!0},model:{value:e.form.share,callback:function(t){e.$set(e.form,"share",t)},expression:"form.share"}},[e._v("共享    ")]),e._v(" "),a("el-radio",{staticStyle:{"margin-left":"-19px","margin-top":"-5px"},attrs:{size:"small",label:!1},model:{value:e.form.share,callback:function(t){e.$set(e.form,"share",t)},expression:"form.share"}},[e._v("取消共享")])],1)]),e._v(" "),a("div",{class:{"form-group":!0,"has-error":e.errors.has("subfetch")}},[a("label",{staticClass:"col-sm-4 control-label"},[e._v("其它选项\n        ")]),e._v(" "),a("div",{staticClass:"col-sm-7 checkbox"},[a("el-checkbox",{staticStyle:{"margin-left":"-19px","margin-top":"-5px"},attrs:{size:"small",name:"subfetch"},model:{value:e.form.subfetch,callback:function(t){e.$set(e.form,"subfetch","string"==typeof t?t.trim():t)},expression:"form.subfetch"}},[e._v("\n                包含子节点  \n            ")]),e._v(" "),a("el-checkbox",{staticStyle:{"margin-left":"-19px","margin-top":"-5px"},attrs:{size:"small",name:"uptrace"},model:{value:e.form.uptrace,callback:function(t){e.$set(e.form,"uptrace","string"==typeof t?t.trim():t)},expression:"form.uptrace"}},[e._v("\n                包含父节点\n            ")])],1)])])},n=[],r={render:o,staticRenderFns:n};t.a=r},DNJ5:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,a){function o(n,r){try{var s=t[n](r),i=s.value}catch(e){return void a(e)}if(!s.done)return Promise.resolve(i).then(function(e){o("next",e)},function(e){o("throw",e)});e(i)}return o("next")})}}Object.defineProperty(t,"__esModule",{value:!0});var r=a("A9K1"),s=o(r),i=a("0iPh"),l=o(i);t.default={props:{vtype:{type:String,default:""}},data:function(){return{bLoading:!1,cascades:[],users:[],form:this.defForm()}},components:{FormDlg:s.default},computed:{title:function(){return this.form.share?"共享节点":"取消共享节点"}},methods:{defForm:function(){return{serial:"",code:"",name:"",target:"cascade",cascade_id:"",username:"",subfetch:!0,uptrace:!1,devtree:!0,share:!0,share_all_channel:!1}},onHide:function(){this.form=this.defForm(),"标准版"!=this.vtype?this.form.target="cascade":this.form.target="user",this.bLoading=!1,this.cascades=[],this.users=[],this.$emit("hide")},onShow:function(){this.errors.clear(),this.$emit("show")},onSubmit:function(){var e=this;return n(regeneratorRuntime.mark(function t(){var a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$validator.validateAll();case 2:if(a=t.sent){t.next=8;break}return o=e.errors.items[0],e.$message({type:"error",message:o.msg}),(0,l.default)("[name="+o.field+"]").focus(),t.abrupt("return");case 8:if("cascade"!=e.form.target){t.next=18;break}if(e.form.cascade_id){t.next=12;break}return e.$message({type:"error",message:"请选择上级平台"}),t.abrupt("return");case 12:if(!e.form.share_all_channel||e.form.share){t.next=15;break}return e.$message({type:"error",message:"上级平台已被标记为全部共享"}),t.abrupt("return");case 15:l.default.get("/api/v1/cascade/sharenode",{serial:e.form.serial,code:e.form.code,cascade_id:e.form.cascade_id,share:e.form.share,subfetch:e.form.subfetch,uptrace:e.form.uptrace,devtree:e.form.devtree}).then(function(t){e.$refs.dlg.hide(),e.$emit("submit"),e.$message({type:"success",message:"操作成功"})}),t.next=26;break;case 18:if("user"!=e.form.target){t.next=26;break}if(e.form.username){t.next=22;break}return e.$message({type:"error",message:"请选择用户"}),t.abrupt("return");case 22:if(!e.form.share_all_channel||e.form.share){t.next=25;break}return e.$message({type:"error",message:"用户已被标记为全部共享"}),t.abrupt("return");case 25:l.default.get("/api/v1/user/sharenode",{serial:e.form.serial,code:e.form.code,username:e.form.username,share:e.form.share,subfetch:e.form.subfetch,uptrace:e.form.uptrace,devtree:e.form.devtree}).then(function(t){e.$refs.dlg.hide(),e.$emit("submit"),e.$message({type:"success",message:"操作成功"})});case 26:case"end":return t.stop()}},t,e)}))()},show:function(e){var t=this;this.errors.clear(),e&&(this.form.serial=e.serial,this.form.code=e.code,this.form.name=e.customName||e.name||e.code,this.form.devtree=!!e.devtree),"标准版"!=this.vtype?(this.form.target="cascade",this.loadCascade()):(this.form.target="user",this.loadUser()),this.$nextTick(function(){t.$refs.dlg.show()})},loadCascade:function(e){var t=this;this.bLoading=!0,l.default.get("/api/v1/cascade/list",{q:e,limit:10}).then(function(e){t.cascades=e.CascadeList||[]}).always(function(){t.$nextTick(function(){t.bLoading=!1})})},loadUser:function(e){var t=this;this.bLoading=!0,l.default.get("/api/v1/user/list",{q:e,limit:10}).then(function(e){t.users=e.UserList||[]}).always(function(){t.$nextTick(function(){t.bLoading=!1})})},changeTarget:function(e){"cascade"==e?this.loadCascade():"user"==e&&this.loadUser()},changeCascade:function(e){if(e){this.form.cascade_id=e;var t=!0,a=!1,o=void 0;try{for(var n,r=this.cascades[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){var s=n.value;if(s.ID==e){this.form.share_all_channel=!!s.ShareAllChannel;break}}}catch(e){a=!0,o=e}finally{try{!t&&r.return&&r.return()}finally{if(a)throw o}}}else this.form.cascade_id="",this.form.share_all_channel=!1},changeUser:function(e){if(e){this.form.username=e;var t=!0,a=!1,o=void 0;try{for(var n,r=this.users[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){var s=n.value;if(s.Username==e){this.form.share_all_channel=!!s.HasAllChannel;break}}}catch(e){a=!0,o=e}finally{try{!t&&r.return&&r.return()}finally{if(a)throw o}}}else this.form.username="",this.form.share_all_channel=!1},clearCascade:function(){this.form.cascade_id="",this.loadCascade()},clearUser:function(){this.form.username="",this.loadUser()},renderUsername:function(e){var t=e.Username||e.ID;return e.HasAllChannel&&(t+="(全部共享)"),t},renderCascadeName:function(e){var t=e.Name||e.Serial||e.ID;return e.ShareAllChannel&&(t+="(全部共享)"),t}}}},Efkx:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("DNJ5"),n=a.n(o);for(var r in o)["default","default"].indexOf(r)<0&&function(e){a.d(t,e,function(){return o[e]})}(r);var s=a("ALqx"),i=a("VU/8"),l=i(n.a,s.a,!1,null,null,null);t.default=l.exports},IFhJ:function(e,t,a){t=e.exports=a("FZ+f")(!1),t.push([e.i,".modal-content[data-v-346de4a3]{overflow:hidden}@media screen and (min-width:992px){.modal-dialog.modal-lgg[data-v-346de4a3]{width:90%}}@media screen and (min-width:1200px){.modal-dialog.modal-lgg[data-v-346de4a3]{width:1200px}}",""])},JK3F:function(e,t,a){!function(t,a){e.exports=a()}(0,function(){return function(e){function t(o){if(a[o])return a[o].exports;var n=a[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var a={};return t.m=e,t.c=a,t.i=function(e){return e},t.d=function(e,a,o){t.o(e,a)||Object.defineProperty(e,a,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(a,"a",a),a},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=4)}([function(e,t,a){var o=a(2)(a(1),a(3),null,null,null);o.options.__file="C:\\Users\\Administrator\\Documents\\vue-context-menu\\src\\VueContextMenu.vue",o.esModule&&Object.keys(o.esModule).some(function(e){return"default"!==e&&"__"!==e.substr(0,2)})&&console.error("named exports are not supported in *.vue files."),o.options.functional&&console.error("[vue-loader] VueContextMenu.vue: functional components are not supported with templates, they should use render functions."),e.exports=o.exports},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"context-menu",data:function(){return{triggerShowFn:function(){},triggerHideFn:function(){},x:null,y:null,style:{},binded:!1}},props:{target:null,show:Boolean},mounted:function(){this.bindEvents()},watch:{show:function(e){e?this.bindHideEvents():this.unbindHideEvents()},target:function(e){this.bindEvents()}},methods:{bindEvents:function(){var e=this;this.$nextTick(function(){e.target&&!e.binded&&(e.triggerShowFn=e.contextMenuHandler.bind(e),e.target.addEventListener("contextmenu",e.triggerShowFn),e.binded=!0)})},unbindEvents:function(){this.target&&this.target.removeEventListener("contextmenu",this.triggerShowFn)},bindHideEvents:function(){this.triggerHideFn=this.clickDocumentHandler.bind(this),document.addEventListener("mousedown",this.triggerHideFn),document.addEventListener("mousewheel",this.triggerHideFn)},unbindHideEvents:function(){document.removeEventListener("mousedown",this.triggerHideFn),document.removeEventListener("mousewheel",this.triggerHideFn)},clickDocumentHandler:function(e){this.$emit("update:show",!1)},contextMenuHandler:function(e){this.x=e.clientX,this.y=e.clientY,this.$emit("update:show",!0),e.preventDefault(),this.$nextTick(this.layout)},layout:function(){if(this.y+this.$el.offsetHeight>document.documentElement.clientHeight)return void(this.style={left:this.x+"px",bottom:0});this.style={left:this.x+"px",top:this.y+"px"}}}}},function(e,t){e.exports=function(e,t,a,o,n){var r,s=e=e||{},i=typeof e.default;"object"!==i&&"function"!==i||(r=e,s=e.default);var l="function"==typeof s?s.options:s;t&&(l.render=t.render,l.staticRenderFns=t.staticRenderFns),o&&(l._scopeId=o);var c;if(n?(c=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),a&&a.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(n)},l._ssrRegister=c):a&&(c=a),c){var u=l.functional,d=u?l.render:l.beforeCreate;u?l.render=function(e,t){return c.call(t),d(e,t)}:l.beforeCreate=d?[].concat(d,c):[c]}return{esModule:r,exports:s,options:l}}},function(e,t,a){e.exports={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],staticStyle:{display:"block"},style:e.style,on:{mousedown:function(e){e.stopPropagation()},contextmenu:function(e){e.preventDefault()}}},[e._t("default")],2)},staticRenderFns:[]},e.exports.render._withStripped=!0},function(e,t,a){const o=a(0),n={};n.install=function(e,t){e.component(o.name,o)},n.component=o,"undefined"!=typeof window&&window.Vue&&window.Vue.use(n),e.exports=n}])})},KVeD:function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:["modal",{fade:e.fade}],attrs:{"data-backdrop":"static","data-disable":"false","data-keyboard":"true",tabindex:"-1"}},[a("div",{class:["modal-dialog",e.size]},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header"},[e._m(0),e._v(" "),a("h4",{staticClass:"modal-title text-center text-primary"},[a("span",[e._v(e._s(e.title))])])]),e._v(" "),a("div",{staticClass:"modal-body"},[a("div",{staticClass:"form-inline",attrs:{autocomplete:"off",spellcheck:"false"}},[a("div",{staticClass:"form-group form-group-sm"},[a("label",[e._v("搜索")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.q,expression:"q",modifiers:{trim:!0}}],ref:"q",staticClass:"form-control",attrs:{type:"text",placeholder:"关键字"},domProps:{value:e.q},on:{keydown:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;t.preventDefault()},input:function(t){t.target.composing||(e.q=t.target.value.trim())},blur:function(t){e.$forceUpdate()}}})]),e._v(" "),a("span",{staticClass:"hidden-xs"},[e._v("  ")]),e._v(" "),a("div",{staticClass:"form-group form-group-sm"},[a("label",[e._v("在线状态")]),e._v(" "),a("select",{directives:[{name:"model",rawName:"v-model.trim",value:e.online,expression:"online",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{disabled:e.related},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.online=t.target.multiple?a:a[0]}}},[a("option",{attrs:{value:""}},[e._v("全部")]),e._v(" "),a("option",{attrs:{value:"true"}},[e._v("在线")]),e._v(" "),a("option",{attrs:{value:"false"}},[e._v("离线")])])]),e._v(" "),a("span",{staticClass:"hidden-xs"},[e._v("  ")]),e._v(" "),a("div",{staticClass:"form-group form-group-sm"},[a("label",[e._v("轮播间隔(秒)")]),e._v(" "),a("el-input-number",{staticStyle:{width:"100px"},attrs:{size:"mini",placeholder:"轮播间隔 (秒)",min:10,label:"轮播间隔","controls-position":"right"},model:{value:e.interval,callback:function(t){e.interval=t},expression:"interval"}})],1),e._v(" "),a("span",{staticClass:"hidden-xs"},[e._v("  ")]),e._v(" "),a("div",{staticClass:"form-group form-group-sm"},[a("div",{staticClass:"checkbox"},[a("el-checkbox",{staticStyle:{"margin-top":"-5px","padding-left":"0"},attrs:{size:"small",name:"Related"},model:{value:e.related,callback:function(t){e.related="string"==typeof t?t.trim():t},expression:"related"}},[e._v("\r\n                                只看已选("+e._s(e.localChannelsAll.length)+")\r\n                            ")])],1)]),e._v(" "),a("div",{staticClass:"form-group form-group-sm pull-right"},[a("button",{staticClass:"btn btn-primary btn-sm",attrs:{type:"button",disabled:!e.localChannelsAll||!e.localChannelsAll.length},on:{click:function(t){t.preventDefault(),e.startLoopPlay(t)}}},[a("i",{staticClass:"fa fa-play"}),e._v(" 开始轮播")])])]),e._v(" "),a("br"),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"channelTable",attrs:{data:e.related?e.localChannels:e.channels,stripe:"","max-height":500,"element-loading-text":"加载中..."},on:{"sort-change":e.sortChange,select:e.select,"select-all":e.selectAll}},[a("el-table-column",{attrs:{type:"selection",width:"55",fixed:"",selectable:e.selectable}}),e._v(" "),a("el-table-column",{attrs:{prop:"DeviceID",label:"设备国标编号","min-width":"200","show-overflow-tooltip":"",sortable:"custom"}}),e._v(" "),a("el-table-column",{attrs:{prop:"ID",label:"通道国标编号","min-width":"200","show-overflow-tooltip":"",sortable:"custom"}}),e._v(" "),a("el-table-column",{attrs:{prop:"Name",label:"通道名称","min-width":"160",formatter:e.formatName,"show-overflow-tooltip":""}}),e._v(" "),e.related?e._e():a("el-table-column",{attrs:{"min-width":"100",label:"快照"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.isDir(t.row)?a("span",[a("i",{staticClass:"fa fa-sitemap"})]):a("el-popover",{attrs:{"open-delay":1e3,"close-delay":10,placement:"left",title:t.row.ID,width:"400",trigger:"hover"}},[a("img",{staticStyle:{width:"100%",height:"100%"},attrs:{onerror:"this.src='/images/default_snap.png';",src:t.row.SnapURL}}),e._v(" "),a("img",{staticStyle:{height:"30px",width:"50px"},attrs:{slot:"reference",onerror:"this.src='/images/default_snap.png';",src:t.row.SnapURL},slot:"reference"})])]}}])}),e._v(" "),e.related?e._e():a("el-table-column",{attrs:{prop:"Status",label:"在线状态","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.isDir(t.row)?a("span",[e._v("-")]):"ON"==(t.row.CustomStatus||t.row.Status)?a("span",{class:{"text-success":"ON"==t.row.Status,"text-orange":!!t.row.CustomStatus}},[e._v("在线")]):a("span",{class:{"text-orange":!!t.row.CustomStatus}},[e._v("离线")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"Manufacturer",label:"厂家","min-width":"120",formatter:e.formatManufacturer,"show-overflow-tooltip":""}})],1),e._v(" "),e.total>0&&!e.related?a("el-pagination",{staticClass:"pull-right",attrs:{layout:"total,prev,pager,next,sizes",pageSizes:[10,20,50,100,200],"pager-count":e.isMobile()?3:5,total:e.total,"page-size":e.pageSize,"current-page":e.currentPage},on:{"update:pageSize":function(t){e.pageSize=t},"update:currentPage":function(t){e.currentPage=t}}}):e._e(),e._v(" "),a("div",{staticClass:"clearfix"})],1)])])])},n=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("span",{attrs:{"aria-hidden":"true"}},[e._v("×")])])}],r={render:o,staticRenderFns:n};t.a=r},LbQQ:function(e,t,a){var o=a("rF1v");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);a("rjj0")("080cae9a",o,!0,{})},"Lc/B":function(e,t,a){var o=a("54Qq");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);a("rjj0")("c66f14dc",o,!0,{})},NTHK:function(e,t,a){var o=a("sgWE");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);a("rjj0")("5493c6b4",o,!0,{})},P4y8:function(e,t,a){"use strict";function o(e){a("X/UB")}Object.defineProperty(t,"__esModule",{value:!0});var n=a("qYg5"),r=a.n(n);for(var s in n)["default","default"].indexOf(s)<0&&function(e){a.d(t,e,function(){return n[e]})}(s);var i=a("T2Nl"),l=a("VU/8"),c=o,u=l(r.a,i.a,!1,c,"data-v-51770df6",null);t.default=u.exports},RUmD:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,a){function o(n,r){try{var s=t[n](r),i=s.value}catch(e){return void a(e)}if(!s.done)return Promise.resolve(i).then(function(e){o("next",e)},function(e){o("throw",e)});e(i)}return o("next")})}}Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},s=a("A9K1"),i=o(s),l=a("0iPh"),c=o(l),u=a("NYxO");t.default={data:function(){return{bImport:!1,bLoading:!1,devices:[],form:this.defForm()}},components:{FormDlg:i.default},computed:r({},(0,u.mapState)(["userInfo","serverInfo"]),{title:function(){return this.form.add?this.bImport?"导入设备":this.form.custom?"新建分组":"新建节点":this.form.custom?"编辑分组":"编辑名称"},labelHeader:function(){return this.form.add?"分组":this.form.custom?"分组":this.form.serial&&!this.form.code?"设备":this.form.serial&&this.form.code?"通道":"节点"},codePlaceholder:function(){return this.form.add?!this.form.serial||this.form.serial.length<4?"1~20位数字":"1~20位数字, 推荐使用行政编号, 如: "+this.form.serial.substring(0,4):""}}),methods:{defForm:function(){return{id:"",serial:"",code:"",name:"",custom_id:"",custom_name:"",parent_id:"",parent_name:"根节点",custom:!1,add:!1,virtual:!1,import_serial:"",new_code:""}},onHide:function(){this.form=this.defForm(),this.bLoading=!1,this.bImport=!1,this.devices=[],this.$emit("hide")},onShow:function(){this.errors.clear(),this.$emit("show"),"编辑名称"==this.title&&this.$el.querySelector("#input-name").focus()},onSubmit:function(){var e=this;return n(regeneratorRuntime.mark(function t(){var a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$validator.validateAll();case 2:if(a=t.sent){t.next=8;break}return o=e.errors.items[0],e.$message({type:"error",message:o.msg}),(0,c.default)("[name="+o.field+"]").focus(),t.abrupt("return");case 8:e.form.virtual&&e.form.add?c.default.get("/api/v1/channel/virtual/add",{serial:e.form.serial,code:e.form.code,name:e.form.custom_name,parent_id:e.form.parent_id}).then(function(t){e.$refs.dlg.hide(),e.$emit("submit")}):c.default.get("/api/v1/channel/save",{serial:e.form.serial,code:e.form.code,name:e.form.custom_name,parent_id:e.form.parent_id,add:e.form.add,import_serial:e.form.import_serial,new_code:e.form.new_code,custom_id:e.form.custom_id}).then(function(t){e.$refs.dlg.hide(),e.$emit("submit")});case 9:case"end":return t.stop()}},t,e)}))()},show:function(e){var t=this;this.errors.clear(),e&&(this.bImport=!!e.import,this.form.add=!!e.add,this.form.id=e.id,this.form.serial=e.serial,this.form.code=e.code,this.form.name=e.name,this.form.custom_id=e.customID,this.form.custom_name=e.customName,this.form.custom=!!e.custom,e.custom&&(this.form.new_code=e.code,this.form.custom_name=e.name,this.form.custom_id="",this.form.name=""),e.parent&&(this.form.parent_id=e.parent.code,this.form.parent_name=e.parent.customName||e.parent.name||e.parent.id,this.form.virtual="virtual"===e.parent.manufacturer)),this.bImport&&this.loadDevice(),this.$nextTick(function(){t.$refs.dlg.show()})},loadDevice:function(e){var t=this;this.bLoading=!0,c.default.get("/api/v1/device/list",{q:e,limit:10}).then(function(e){t.devices=e.DeviceList||[]}).always(function(){t.$nextTick(function(){t.bLoading=!1})})},changeDevice:function(e){var t=this;e?(this.form.code=e,20==e.length&&"216"!=e.substring(10,13)&&(this.form.code=e.substring(0,10)+"216"+e.substring(13)),this.form.import_serial=e,this.$nextTick(function(){t.form.custom_name=t.$refs.selectDevice.selectedLabel})):(this.form.code="",this.form.custom_name="",this.form.import_serial="")},clearDevice:function(){this.form.code="",this.form.custom_name="",this.form.import_serial="",this.loadDevice()}}}},T2Nl:function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:["modal",{fade:e.fade}],attrs:{"data-backdrop":"static","data-disable":"false","data-keyboard":"true",tabindex:"-1"}},[a("div",{class:["modal-dialog",e.size]},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header"},[e._m(0),e._v(" "),a("h4",{staticClass:"modal-title text-center text-primary"},[a("span",[e._v(e._s(e.title))])])]),e._v(" "),a("div",{staticClass:"modal-body"},[a("div",{staticClass:"form-inline",attrs:{autocomplete:"off",spellcheck:"false"}},[a("div",{staticClass:"form-group form-group-sm"},[a("label",[e._v("搜索")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.q,expression:"q",modifiers:{trim:!0}}],ref:"q",staticClass:"form-control",attrs:{type:"text",placeholder:"关键字"},domProps:{value:e.q},on:{keydown:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;t.preventDefault()},input:function(t){t.target.composing||(e.q=t.target.value.trim())},blur:function(t){e.$forceUpdate()}}})]),e._v(" "),a("span",{staticClass:"hidden-xs"},[e._v("  ")]),e._v(" "),a("div",{staticClass:"form-group form-group-sm"},[a("label",[e._v("在线状态")]),e._v(" "),a("select",{directives:[{name:"model",rawName:"v-model.trim",value:e.online,expression:"online",modifiers:{trim:!0}}],staticClass:"form-control",on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.online=t.target.multiple?a:a[0]}}},[a("option",{attrs:{value:""}},[e._v("全部")]),e._v(" "),a("option",{attrs:{value:"true"}},[e._v("在线")]),e._v(" "),a("option",{attrs:{value:"false"}},[e._v("离线")])])])]),e._v(" "),a("br"),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"channelTable",attrs:{data:e.channels,stripe:"","max-height":500,"row-style":e.rowStyle,"element-loading-text":"加载中..."},on:{"sort-change":e.sortChange,"row-click":e.rowClick,"row-dblclick":e.rowDblclick}},[a("el-table-column",{attrs:{prop:"DeviceID",label:"设备国标编号","min-width":"200","show-overflow-tooltip":"",sortable:"custom"}}),e._v(" "),a("el-table-column",{attrs:{prop:"ID",label:"通道国标编号","min-width":"200","show-overflow-tooltip":"",sortable:"custom"}}),e._v(" "),a("el-table-column",{attrs:{prop:"Name",label:"通道名称","min-width":"160",formatter:e.formatName,"show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"100",label:"快照"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.isDir(t.row)?a("span",[a("i",{staticClass:"fa fa-sitemap"})]):a("el-popover",{attrs:{"open-delay":1e3,"close-delay":10,placement:"left",title:t.row.ID,width:"400",trigger:"hover"}},[a("img",{staticStyle:{width:"100%",height:"100%"},attrs:{onerror:"this.src='/images/default_snap.png';",src:t.row.SnapURL}}),e._v(" "),a("img",{staticStyle:{height:"30px",width:"50px"},attrs:{slot:"reference",onerror:"this.src='/images/default_snap.png';",src:t.row.SnapURL},slot:"reference"})])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"Status",label:"在线状态","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.isDir(t.row)?a("span",[e._v("-")]):"ON"==(t.row.CustomStatus||t.row.Status)?a("span",{class:{"text-success":"ON"==t.row.Status,"text-orange":!!t.row.CustomStatus}},[e._v("在线")]):a("span",{class:{"text-orange":!!t.row.CustomStatus}},[e._v("离线")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"Manufacturer",label:"厂家","min-width":"120",formatter:e.formatManufacturer,"show-overflow-tooltip":""}})],1),e._v(" "),e.total>0?a("el-pagination",{staticClass:"pull-right",attrs:{layout:"total,prev,pager,next","pager-count":e.isMobile()?3:5,total:e.total,"page-size":e.pageSize,"current-page":e.currentPage},on:{"update:pageSize":function(t){e.pageSize=t},"update:currentPage":function(t){e.currentPage=t}}}):e._e(),e._v(" "),a("div",{staticClass:"clearfix"})],1)])])])},n=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("span",{attrs:{"aria-hidden":"true"}},[e._v("×")])])}],r={render:o,staticRenderFns:n};t.a=r},Tykz:function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("FormDlg",{ref:"dlg",attrs:{title:e.title,disabled:e.errors.any()},on:{hide:e.onHide,show:e.onShow,submit:e.onSubmit}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.form.parent_id||e.form.parent_name,expression:"form.parent_id || form.parent_name"}],class:{"form-group":!0,"has-error":e.errors.has("parentid")}},[a("label",{staticClass:"col-sm-4 control-label",attrs:{for:"input-parentid"}},[e._v("父节点\n            ")]),e._v(" "),a("div",{staticClass:"col-sm-7"},[a("select",{directives:[{name:"model",rawName:"v-model.trim",value:e.form.parent_id,expression:"form.parent_id",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{id:"input-parentid","data-vv-as":"父节点",disabled:"disabled"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.$set(e.form,"parent_id",t.target.multiple?a:a[0])}}},[a("option",{domProps:{value:e.form.parent_id}},[e._v(e._s(e.form.parent_name))])])])]),e._v(" "),a("div",{class:{"form-group":!0,"has-error":e.errors.has("serial")}},[a("label",{staticClass:"col-sm-4 control-label",attrs:{for:"input-serial"}},[e._v("设备编号\n            "),a("span",{staticClass:"text-red"},[e._v("*")])]),e._v(" "),a("div",{staticClass:"col-sm-7"},[a("input",{staticClass:"form-control",attrs:{type:"text",readonly:"readonly",id:"input-serial",name:"serial","data-vv-as":"设备编号"},domProps:{value:e.form.serial}})])]),e._v(" "),e.bImport?a("div",{class:{"form-group":!0,"has-error":e.errors.has("import_serial")}},[a("label",{staticClass:"col-sm-4 control-label",attrs:{for:"input-serial"}},[e._v("导入设备\n            "),a("span",{staticClass:"text-red"},[e._v("*")])]),e._v(" "),a("div",{staticClass:"col-sm-7"},[a("el-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],ref:"selectDevice",staticStyle:{width:"100%"},attrs:{filterable:"",clearable:"",remote:"","remote-method":e.loadDevice,loading:e.bLoading,id:"input-import-serial",name:"import_serial","data-vv-as":"导入设备",placeholder:"搜索",size:"small"},on:{change:e.changeDevice,clear:e.clearDevice},model:{value:e.form.import_serial,callback:function(t){e.$set(e.form,"import_serial",t)},expression:"form.import_serial"}},e._l(e.devices,function(e){return a("el-option",{key:e.ID,attrs:{label:e.CustomName||e.Name||e.ID,value:e.ID}})}))],1)]):e._e(),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.form.add||e.form.code,expression:"form.add || form.code"}],class:{"form-group":!0,"has-error":e.errors.has("code")}},[a("label",{staticClass:"col-sm-4 control-label",attrs:{for:"input-code"}},[e._v(e._s(e.labelHeader)+"编号\n            "),e.form.add||e.form.custom?a("span",{staticClass:"text-red"},[e._v("*")]):e._e()]),e._v(" "),a("div",{staticClass:"col-sm-7"},[e.form.add?a("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.form.code,expression:"form.code",modifiers:{trim:!0}},{name:"validate",rawName:"v-validate",value:"required|regex:^[0-9]+$",expression:"'required|regex:^[0-9]+$'"}],staticClass:"form-control",attrs:{type:"text",id:"input-code",name:"code",placeholder:e.codePlaceholder,"data-vv-as":"节点编号"},domProps:{value:e.form.code},on:{keydown:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.$el.querySelector("#input-name").focus()},input:function(t){t.target.composing||e.$set(e.form,"code",t.target.value.trim())},blur:function(t){e.$forceUpdate()}}}):e.form.custom?a("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.form.new_code,expression:"form.new_code",modifiers:{trim:!0}},{name:"validate",rawName:"v-validate",value:"required|regex:^[0-9]+$",expression:"'required|regex:^[0-9]+$'"}],staticClass:"form-control",attrs:{type:"text",id:"input-code",name:"code",placeholder:e.codePlaceholder,"data-vv-as":"节点编号"},domProps:{value:e.form.new_code},on:{keydown:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.$el.querySelector("#input-name").focus()},input:function(t){t.target.composing||e.$set(e.form,"new_code",t.target.value.trim())},blur:function(t){e.$forceUpdate()}}}):a("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.form.code,expression:"form.code",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",readonly:"readonly",id:"input-code",name:"code","data-vv-as":"节点编号"},domProps:{value:e.form.code},on:{input:function(t){t.target.composing||e.$set(e.form,"code",t.target.value.trim())},blur:function(t){e.$forceUpdate()}}})])]),e._v(" "),"标准版"!=e.serverInfo.VersionType&&!e.form.add&&!e.form.custom&&e.form.serial&&e.form.code?a("div",{class:{"form-group":!0,"has-error":e.errors.has("custom_id")}},[a("label",{staticClass:"col-sm-4 control-label",attrs:{for:"input-custom-id"}},[e._v("自定义通道编号\n        ")]),e._v(" "),a("div",{staticClass:"col-sm-7"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.form.custom_id,expression:"form.custom_id",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",id:"input-custom-id",name:"custom_id",placeholder:"可选, 用于级联","data-vv-as":"自定义通道编号",oninput:"value=value.replace(/[^\\d]/g,'')"},domProps:{value:e.form.custom_id},on:{keydown:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;t.preventDefault(),e.$el.querySelector("#input-name").focus()},input:function(t){t.target.composing||e.$set(e.form,"custom_id",t.target.value.trim())},blur:function(t){e.$forceUpdate()}}})])]):e._e(),e._v(" "),a("div",{class:{"form-group":!0,"has-error":e.errors.has("name")}},[a("label",{staticClass:"col-sm-4 control-label",attrs:{for:"input-name"}},[e._v(e._s(e.labelHeader)+"名称\n        ")]),e._v(" "),a("div",{staticClass:"col-sm-7"},[a("div",{staticClass:"input-group",staticStyle:{width:"100%"}},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.form.custom_name,expression:"form.custom_name",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",id:"input-name",name:"name",placeholder:e.form.name||e.form.code||e.form.serial,"data-vv-as":"节点名称"},domProps:{value:e.form.custom_name},on:{keydown:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.onSubmit(t)},input:function(t){t.target.composing||e.$set(e.form,"custom_name",t.target.value.trim())},blur:function(t){e.$forceUpdate()}}}),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.form.custom_name||e.form.name,expression:"form.custom_name || form.name"}],staticClass:"input-group-btn"},[a("button",{directives:[{name:"clipboard",rawName:"v-clipboard",value:e.form.custom_name||e.form.name,expression:"form.custom_name || form.name"}],staticClass:"btn btn-default",staticStyle:{"border-top-right-radius":"0","border-bottom-right-radius":"0"},attrs:{type:"button",title:e.form.custom?"拷贝名称":e.form.custom_name?"拷贝自定义名称":"拷贝原名称"},on:{success:function(t){e.$message({type:"success",message:"成功拷贝到粘贴板"})}}},[a("i",{staticClass:"fa fa-copy"})])])])])])])},n=[],r={render:o,staticRenderFns:n};t.a=r},Wd3z:function(e,t,a){t=e.exports=a("FZ+f")(!1),t.push([e.i,".right-menu[data-v-ec71958a]{position:fixed;background:#fff;border:1px solid rgba(0,0,0,.2);border-radius:3px;z-index:999;display:none}.right-menu a[data-v-ec71958a]{width:100px;height:28px;line-height:28px;text-align:center;display:block;color:#1a1a1a}.right-menu a[data-v-ec71958a]:hover{background:#eee;color:#fff}.right-menu[data-v-ec71958a]{border:1px solid #eee;box-shadow:0 .5em 1em 0 rgba(0,0,0,.1);border-radius:1px}a[data-v-ec71958a]{text-decoration:none}.right-menu a[data-v-ec71958a]{padding:2px}.right-menu a[data-v-ec71958a]:hover{background:#567}.view-list .nav.nav-tabs>li a[data-v-ec71958a]{background-color:transparent}.view-list .nav.nav-tabs>li.active a[data-v-ec71958a]{background-color:#dbe3ec}.view-list .video-show .video[data-v-ec71958a]{border:1px solid #fff}.view-list .video-show .col-sm-12[data-v-ec71958a]:first-child{border:0}.view-list .video-show .col-sm-6[data-v-ec71958a]:first-child,.view-list .video-show .col-sm-6[data-v-ec71958a]:nth-child(2){border-top-color:transparent}.view-list .video-show .col-sm-6[data-v-ec71958a]:nth-child(2),.view-list .video-show .col-sm-6[data-v-ec71958a]:nth-child(4){border-right-color:transparent}.view-list .video-show .col-sm-6[data-v-ec71958a]:first-child,.view-list .video-show .col-sm-6[data-v-ec71958a]:nth-child(3){border-left-color:transparent}.view-list .video-show .col-sm-6[data-v-ec71958a]:nth-child(3),.view-list .video-show .col-sm-6[data-v-ec71958a]:nth-child(4){border-bottom-color:transparent}.view-list .video-show .col-sm-4[data-v-ec71958a]:first-child,.view-list .video-show .col-sm-4[data-v-ec71958a]:nth-child(2),.view-list .video-show .col-sm-4[data-v-ec71958a]:nth-child(3){border-top-color:transparent}.view-list .video-show .col-sm-4[data-v-ec71958a]:nth-child(3),.view-list .video-show .col-sm-4[data-v-ec71958a]:nth-child(6),.view-list .video-show .col-sm-4[data-v-ec71958a]:nth-child(9){border-right-color:transparent}.view-list .video-show .col-sm-4[data-v-ec71958a]:nth-child(7),.view-list .video-show .col-sm-4[data-v-ec71958a]:nth-child(8),.view-list .video-show .col-sm-4[data-v-ec71958a]:nth-child(9){border-bottom-color:transparent}.view-list .video-show .col-sm-4[data-v-ec71958a]:first-child,.view-list .video-show .col-sm-4[data-v-ec71958a]:nth-child(4),.view-list .video-show .col-sm-4[data-v-ec71958a]:nth-child(7){border-left-color:transparent}.view-list .video-show .col-sm-3[data-v-ec71958a]:first-child,.view-list .video-show .col-sm-3[data-v-ec71958a]:nth-child(2),.view-list .video-show .col-sm-3[data-v-ec71958a]:nth-child(3),.view-list .video-show .col-sm-3[data-v-ec71958a]:nth-child(4){border-top-color:transparent}.view-list .video-show .col-sm-3[data-v-ec71958a]:nth-child(4),.view-list .video-show .col-sm-3[data-v-ec71958a]:nth-child(8),.view-list .video-show .col-sm-3[data-v-ec71958a]:nth-child(12),.view-list .video-show .col-sm-3[data-v-ec71958a]:nth-child(16){border-right-color:transparent}.view-list .video-show .col-sm-3[data-v-ec71958a]:nth-child(13),.view-list .video-show .col-sm-3[data-v-ec71958a]:nth-child(14),.view-list .video-show .col-sm-3[data-v-ec71958a]:nth-child(15),.view-list .video-show .col-sm-3[data-v-ec71958a]:nth-child(16){border-bottom-color:transparent}.view-list .video-show .col-sm-3[data-v-ec71958a]:first-child,.view-list .video-show .col-sm-3[data-v-ec71958a]:nth-child(5),.view-list .video-show .col-sm-3[data-v-ec71958a]:nth-child(9),.view-list .video-show .col-sm-3[data-v-ec71958a]:nth-child(13){border-left-color:transparent}.fullscreen[data-v-ec71958a]{width:100%!important}.video-close[data-v-ec71958a]{right:5px;font-size:12px;cursor:pointer;max-width:120px}.video-close[data-v-ec71958a],.video-title[data-v-ec71958a]{position:absolute;top:5px;color:#fff;background-color:hsla(0,0%,50%,.5);padding:2px 5px;border-radius:2px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.video-title[data-v-ec71958a]{left:5px;font-size:14px;max-width:200px}.player-btn-group[data-v-ec71958a]{margin:5px 0}.player-btn-group .el-button--primary[data-v-ec71958a]{color:#567;background:#fff;border:1px solid #dcdfe6!important}.player-btn-group .active[data-v-ec71958a]{background-color:#404d59;color:#fff}@media screen and (max-width:992px){#tab-tree-wrapper[data-v-ec71958a]{min-height:200px}}#dev-tree[data-v-ec71958a],#group-tree[data-v-ec71958a]{min-height:200px;overflow:auto;background-color:transparent}@media screen and (max-width:992px){#dev-tree[data-v-ec71958a],#group-tree[data-v-ec71958a]{max-height:200px}}#query-dev-tree[data-v-ec71958a],#query-group-tree[data-v-ec71958a]{min-height:200px;overflow:auto}@media screen and (max-width:992px){#query-dev-tree[data-v-ec71958a],#query-group-tree[data-v-ec71958a]{max-height:200px}}.el-tree-node.is-drop-inner>.el-tree-node__content .custom-tree-node[data-v-ec71958a]{background-color:#567;color:#fff}#screen-sticky>#screen-sticky-bottom[data-v-ec71958a]{display:none}#screen-sticky-wrapper.sticky>#screen-sticky>#screen-sticky-bottom[data-v-ec71958a]{display:block}",""])},"X/UB":function(e,t,a){var o=a("aVWt");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);a("rjj0")("f907a2d8",o,!0,{})},YUeX:function(e,t,a){"use strict";function o(e){a("uL6E")}Object.defineProperty(t,"__esModule",{value:!0});var n=a("chve"),r=a.n(n);for(var s in n)["default","default"].indexOf(s)<0&&function(e){a.d(t,e,function(){return n[e]})}(s);var i=a("KVeD"),l=a("VU/8"),c=o,u=l(r.a,i.a,!1,c,"data-v-346de4a3",null);t.default=u.exports},YsA0:function(e,t,a){t=e.exports=a("FZ+f")(!1),t.push([e.i,".modal-content[data-v-7950e622]{overflow:hidden}@media screen and (min-width:992px){.modal-dialog.modal-lgg[data-v-7950e622]{width:90%}}@media screen and (min-width:1200px){.modal-dialog.modal-lgg[data-v-7950e622]{width:1200px}}",""])},aVWt:function(e,t,a){t=e.exports=a("FZ+f")(!1),t.push([e.i,".modal-content[data-v-51770df6]{overflow:hidden}@media screen and (min-width:992px){.modal-dialog.modal-lgg[data-v-51770df6]{width:90%}}@media screen and (min-width:1200px){.modal-dialog.modal-lgg[data-v-51770df6]{width:1200px}}",""])},"b+at":function(e,t,a){var o=a("YsA0");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);a("rjj0")("1c814488",o,!0,{})},chve:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,a){function o(n,r){try{var s=t[n](r),i=s.value}catch(e){return void a(e)}if(!s.done)return Promise.resolve(i).then(function(e){o("next",e)},function(e){o("throw",e)});e(i)}return o("next")})}}Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},s=a("M4fF"),i=o(s),l=a("0iPh"),c=o(l);a("F8S1");var u=a("NYxO");t.default={props:{title:{default:"选择轮巡播放通道"},size:{type:String,default:"modal-lgg"},fade:{type:Boolean,default:!1}},data:function(){return{q:"",online:"true",total:0,pageSize:10,currentPage:1,sort:"",order:"",loading:!1,channels:[],localData:{interval:10,rows:{}},related:!1,localChannels:[],localChannelsAll:[],interval:10}},computed:r({},(0,u.mapState)(["userInfo","serverInfo"])),watch:{q:function(e,t){this.doDelaySearch()},online:function(e,t){this.doSearch()},currentPage:function(e,t){this.doSearch(e)},pageSize:function(e,t){this.doSearch()},related:function(e,t){e?this.loadLocalChannels():this.doSearch()},interval:function(e,t){this.localData.interval=e,this.setLocalData(!0)}},mounted:function(){var e=this;this.loadLocalData(),(0,c.default)(this.$el).find(".modal-content").draggable({handle:".modal-header",cancel:".modal-title span",addClasses:!1,containment:"document",delay:100,opacity:.5}),(0,c.default)(this.$el).on("shown.bs.modal",function(){e.$emit("show")}).on("hidden.bs.modal",function(){e.errors.clear(),e.$emit("hide")})},methods:{sortChange:function(e){this.sort=e.prop,this.order="ascending"==e.order?"asc":"desc",this.getChannels()},doSearch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.currentPage=e,this.related?this.loadLocalChannels():this.getChannels()},doDelaySearch:i.default.debounce(function(){this.doSearch()},800),formatName:function(e,t,a){var o=e.DeviceCustomName||e.DeviceName||"",n=e.CustomName||e.Name||"";return o&&o!=n&&(n=n?n+"@"+o:o),n||"-"},formatDeviceName:function(e,t,a){return e.DeviceCustomName||e.DeviceName||"-"},formatChannelName:function(e,t,a){return e.CustomName||e.Name||"-"},formatManufacturer:function(e,t,a){return a||"-"},getChannels:function(){var e=this;this.loading=!0,c.default.get("/api/v1/device/channellist",{q:this.q,start:(this.currentPage-1)*this.pageSize,limit:this.pageSize,channel_type:"device",online:this.online,sort:this.sort,order:this.order}).then(function(t){e.total=t.ChannelCount,e.channels=t.ChannelList||[],e.$nextTick(function(){e.channels.forEach(function(t){e.localData.rows[t.DeviceID+"_"+t.ID]&&(e.localData.rows[t.DeviceID+"_"+t.ID]=t,e.$refs.channelTable.toggleRowSelection(t))}),e.setLocalData(!1)})}).always(function(){e.$nextTick(function(){e.loading=!1})})},isDir:function(e){if(e){if(e.SubCount>0)return!0;if(this.serverInfo.StrictChannelParental&&1==e.Parental)return!0;if(this.serverInfo.StrictChannelCode&&e.ID.length<=10)return!0;if(1==e.Parental&&"LiveQing"==e.Manufacturer)return!0;if(20==e.ID.length&&("216"==e.ID.substring(10,13)||"215"==e.ID.substring(10,13)))return!0}return!1},reset:function(){this.channels=[],this.q="",this.online="true",this.currentPage=1,this.pageSize=10},show:function(){(0,c.default)(this.$el).modal("show"),this.related?this.loadLocalData():this.getChannels()},hide:function(){(0,c.default)(this.$el).modal("hide")},selectable:function(e,t){return!0},select:function(e,t){var a=this.localData.rows[t.DeviceID+"_"+t.ID]||"";e.indexOf(t)>=0?a||(this.localData.rows[t.DeviceID+"_"+t.ID]=t):a&&delete this.localData.rows[t.DeviceID+"_"+t.ID],this.setLocalData()},selectAll:function(e){if(e.length){this.selection=e;var t=!0,a=!1,o=void 0;try{for(var n,r=e[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){var s=n.value,i=this.localData.rows[s.DeviceID+"_"+s.ID]||"";i||(this.localData.rows[s.DeviceID+"_"+s.ID]=s)}}catch(e){a=!0,o=e}finally{try{!t&&r.return&&r.return()}finally{if(a)throw o}}}else if(this.related){var l=!0,c=!1,u=void 0;try{for(var d,f=this.localChannels[Symbol.iterator]();!(l=(d=f.next()).done);l=!0){var s=d.value,i=this.localData.rows[s.DeviceID+"_"+s.ID]||"";i&&delete this.localData.rows[s.DeviceID+"_"+s.ID]}}catch(e){c=!0,u=e}finally{try{!l&&f.return&&f.return()}finally{if(c)throw u}}}else{var p=!0,h=!1,m=void 0;try{for(var v,g=this.channels[Symbol.iterator]();!(p=(v=g.next()).done);p=!0){var s=v.value,i=this.localData.rows[s.DeviceID+"_"+s.ID]||"";i&&delete this.localData.rows[s.DeviceID+"_"+s.ID]}}catch(e){h=!0,m=e}finally{try{!p&&g.return&&g.return()}finally{if(h)throw m}}}this.setLocalData()},setLocalData:function(e){localStorage.livegbs_screen_loop_play=JSON.stringify(this.localData),e||this.loadLocalChannels()},loadLocalData:function(){localStorage.livegbs_screen_loop_play&&(this.localData=JSON.parse(localStorage.livegbs_screen_loop_play),this.interval=this.localData.interval,this.loadLocalChannels())},loadLocalChannels:function(){var e=this;return n(regeneratorRuntime.mark(function t(){var a,o,n,r,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a=[],o=[],t.t0=regeneratorRuntime.keys(e.localData.rows);case 3:if((t.t1=t.t0()).done){t.next=22;break}if(n=t.t1.value,r=e.localData.rows[n]){t.next=9;break}return delete e.localData.rows[n],t.abrupt("continue",3);case 9:if(e.hasAllChannel(e.serverInfo,e.userInfo)){t.next=16;break}return t.next=12,e.hasChannel(r.DeviceID,r.ID);case 12:if(s=t.sent){t.next=16;break}return delete e.localData.rows[n],t.abrupt("continue",3);case 16:if(o.push(r),!(e.q&&(r.ID+r.DeviceID+r.Name+"").indexOf(e.q)<0)){t.next=19;break}return t.abrupt("continue",3);case 19:a.push(r),t.next=3;break;case 22:e.localChannelsAll=o,e.localChannels=a,e.related&&e.$nextTick(function(){e.localChannels.forEach(function(t){e.$refs.channelTable.toggleRowSelection(t)})});case 25:case"end":return t.stop()}},t,e)}))()},hasChannel:function(e,t){return new Promise(function(a,o){c.default.ajax({method:"GET",url:"/api/v1/device/channelinfo",global:!1,data:{serial:e,code:t}}).then(function(e){a(!0)}).fail(function(e){a(!1)})})},startLoopPlay:function(){if(!this.localChannelsAll||!this.localChannelsAll.length)return void this.$message({type:"warning",message:"请选择需要轮巡播放的通道"});this.$emit("loopPlay",this.localChannelsAll,this.interval),this.hide()}}}},kO2a:function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("FormDlg",{ref:"dlg",attrs:{title:"编辑通道位置",disabled:e.errors.any()||e.form.custom},on:{hide:e.onHide,show:e.onShow,submit:e.onSubmit}},[a("div",{class:{"form-group":!0,"has-error":e.errors.has("serial")}},[a("label",{staticClass:"col-sm-4 control-label",attrs:{for:"input-position-serial"}},[e._v("设备编号\n            "),a("span",{staticClass:"text-red"},[e._v("*")])]),e._v(" "),a("div",{staticClass:"col-sm-7"},[a("input",{staticClass:"form-control",attrs:{type:"text",readonly:"readonly",id:"input-position-serial",name:"serial","data-vv-as":"设备编号"},domProps:{value:e.form.serial}})])]),e._v(" "),a("div",{class:{"form-group":!0,"has-error":e.errors.has("code")}},[a("label",{staticClass:"col-sm-4 control-label",attrs:{for:"input-position-code"}},[e._v("通道编号\n            "),a("span",{staticClass:"text-red"},[e._v("*")])]),e._v(" "),a("div",{staticClass:"col-sm-7"},[a("input",{staticClass:"form-control",attrs:{type:"text",readonly:"readonly",id:"input-position-code",name:"code","data-vv-as":"通道编号"},domProps:{value:e.form.code}})])]),e._v(" "),a("div",{class:{"form-group":!0,"has-error":e.errors.has("name")}},[a("label",{staticClass:"col-sm-4 control-label",attrs:{for:"input-position-name"}},[e._v("通道名称\n        ")]),e._v(" "),a("div",{staticClass:"col-sm-7"},[a("input",{staticClass:"form-control",attrs:{type:"text",readonly:"readonly",id:"input-position-name",name:"name","data-vv-as":"通道名称"},domProps:{value:e.form.name||"-"}})])]),e._v(" "),a("div",{class:{"form-group":!0,"has-error":e.errors.has("longitude")}},[a("label",{staticClass:"col-sm-4 control-label",attrs:{for:"input-position-longitude"}},[e._v("经度\n        ")]),e._v(" "),a("div",{staticClass:"col-sm-7"},[a("input",{directives:[{name:"validate",rawName:"v-validate",value:"decimal",expression:"'decimal'"},{name:"model",rawName:"v-model.trim",value:e.form.customLongitude,expression:"form.customLongitude",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",id:"input-position-longitude",name:"longitude",placeholder:e.form.longitude||"-","data-vv-as":"经度"},domProps:{value:e.form.customLongitude},on:{paste:e.onPasteLngLat,keydown:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.$el.querySelector("#input-position-latitude").focus()},input:function(t){t.target.composing||e.$set(e.form,"customLongitude",t.target.value.trim())},blur:function(t){e.$forceUpdate()}}})])]),e._v(" "),a("div",{class:{"form-group":!0,"has-error":e.errors.has("latitude")}},[a("label",{staticClass:"col-sm-4 control-label",attrs:{for:"input-position-latitude"}},[e._v("纬度\n        ")]),e._v(" "),a("div",{staticClass:"col-sm-7"},[a("input",{directives:[{name:"validate",rawName:"v-validate",value:"decimal",expression:"'decimal'"},{name:"model",rawName:"v-model.trim",value:e.form.customLatitude,expression:"form.customLatitude",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",id:"input-position-latitude",name:"latitude",placeholder:e.form.latitude||"-","data-vv-as":"纬度"},domProps:{value:e.form.customLatitude},on:{paste:e.onPasteLngLat,keydown:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.onSubmit(t)},input:function(t){t.target.composing||e.$set(e.form,"customLatitude",t.target.value.trim())},blur:function(t){e.$forceUpdate()}}})])])])},n=[],r={render:o,staticRenderFns:n};t.a=r},lGU5:function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"modal fade upload-dlg",attrs:{"data-backdrop":"static","data-keyboard":"true",tabindex:"-1"}},[a("div",{staticClass:"modal-dialog"},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header"},[e._m(0),e._v(" "),a("h4",{staticClass:"modal-title text-center text-info"},[a("span",[e._v(e._s(e.title))])])]),e._v(" "),a("div",{staticClass:"modal-body"},[e._t("header"),e._v(" "),a("el-upload",{ref:"uploader",attrs:{drag:e.drag,action:e.url,multiple:e.multiple,"show-file-list":e.showFileList,limit:1,"on-success":e.onSuccess,"on-progress":e.onProgress,"on-error":e.onError,"on-remove":e.onRemove,accept:e.accept,"before-upload":e.beforeUpload,"auto-upload":e.autoUpload}},[a("i",{staticClass:"el-icon-upload"}),e._v(" "),a("div",{staticClass:"el-upload__text"},[e._v("将配置数据拖到此处，或 "),a("em",[e._v("点击上传")])]),e._v(" "),a("div",{staticClass:"el-upload__tip text-center",attrs:{slot:"tip"},slot:"tip"},[e._v(e._s(e.tip)),a("span",{staticStyle:{color:"red"}},[e._v(" *上传成功会自动删除原有数据，请注意导出备份*")])])]),e._v(" "),e._t("footer")],2),e._v(" "),a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-default",attrs:{type:"button","data-dismiss":"modal",disabled:e.bProgress}},[e._v("关闭")])])])])])},n=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("span",{attrs:{"aria-hidden":"true"}},[e._v("×")])])}],r={render:o,staticRenderFns:n};t.a=r},lVCW:function(e,t,a){var o=a("Wd3z");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);a("rjj0")("4d2e9195",o,!0,{})},pFnw:function(e,t,a){"use strict";var o,n,r,s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(s){n=[a("0iPh")],o=s,void 0!==(r="function"==typeof o?o.apply(t,n):o)&&(e.exports=r)}(function(e){var t=Array.prototype.slice,a=Array.prototype.splice,o={topSpacing:0,bottomSpacing:0,className:"sticky",wrapperClassName:"sticky-wrapper",center:!1,getWidthFrom:"",widthFromWrapper:!0,responsiveWidth:!1,zIndex:"auto"},n=e(window),r=e(document),i=[],l=n.height(),c=function(){for(var t=n.scrollTop(),a=r.height(),o=a-l,s=t>o?o-t:0,c=0,u=i.length;c<u;c++){var d=i[c],f=d.stickyWrapper.offset().top,p=f-d.topSpacing-s;if(d.stickyWrapper.css("height",d.stickyElement.outerHeight()),t<=p)null!==d.currentTop&&(d.stickyElement.css({width:"",position:"",top:"","z-index":""}),d.stickyElement.parent().removeClass(d.className),d.stickyElement.trigger("sticky-end",[d]),d.currentTop=null);else{var h=a-d.stickyElement.outerHeight()-d.topSpacing-d.bottomSpacing-t-s;if(h<0?h+=d.topSpacing:h=d.topSpacing,d.currentTop!==h){var m;d.getWidthFrom?m=e(d.getWidthFrom).width()||null:d.widthFromWrapper&&(m=d.stickyWrapper.width()),null==m&&(m=d.stickyElement.width()),d.stickyElement.css("width",m).css("position","fixed").css("top",h).css("z-index",d.zIndex),d.stickyElement.parent().addClass(d.className),null===d.currentTop?d.stickyElement.trigger("sticky-start",[d]):d.stickyElement.trigger("sticky-update",[d]),d.currentTop===d.topSpacing&&d.currentTop>h||null===d.currentTop&&h<d.topSpacing?d.stickyElement.trigger("sticky-bottom-reached",[d]):null!==d.currentTop&&h===d.topSpacing&&d.currentTop<h&&d.stickyElement.trigger("sticky-bottom-unreached",[d]),d.currentTop=h}var v=d.stickyWrapper.parent();d.stickyElement.offset().top+d.stickyElement.outerHeight()>=v.offset().top+v.outerHeight()&&d.stickyElement.offset().top<=d.topSpacing?d.stickyElement.css("position","absolute").css("top","").css("bottom",0).css("z-index",""):d.stickyElement.css("position","fixed").css("top",h).css("bottom","").css("z-index",d.zIndex)}}},u=function(){l=n.height();for(var t=0,a=i.length;t<a;t++){var o=i[t],r=null;o.getWidthFrom?o.responsiveWidth&&(r=e(o.getWidthFrom).width()):o.widthFromWrapper&&(r=o.stickyWrapper.width()),null!=r&&o.stickyElement.css("width",r)}},d={init:function(t){return this.each(function(){var a=e.extend({},o,t),n=e(this),r=n.attr("id"),s=r?r+"-wrapper":o.wrapperClassName,l=e("<div></div>").attr("id",s).addClass(a.wrapperClassName);n.wrapAll(function(){if(0==e(this).parent("#"+s).length)return l});var c=n.parent();a.center&&c.css({width:n.outerWidth(),marginLeft:"auto",marginRight:"auto"}),"right"===n.css("float")&&n.css({float:"none"}).parent().css({float:"right"}),a.stickyElement=n,a.stickyWrapper=c,a.currentTop=null,i.push(a),d.setWrapperHeight(this),d.setupChangeListeners(this)})},setWrapperHeight:function(t){var a=e(t),o=a.parent();o&&o.css("height",a.outerHeight())},setupChangeListeners:function(e){if(window.MutationObserver){new window.MutationObserver(function(t){(t[0].addedNodes.length||t[0].removedNodes.length)&&d.setWrapperHeight(e)}).observe(e,{subtree:!0,childList:!0})}else window.addEventListener?(e.addEventListener("DOMNodeInserted",function(){d.setWrapperHeight(e)},!1),e.addEventListener("DOMNodeRemoved",function(){d.setWrapperHeight(e)},!1)):window.attachEvent&&(e.attachEvent("onDOMNodeInserted",function(){d.setWrapperHeight(e)}),e.attachEvent("onDOMNodeRemoved",function(){d.setWrapperHeight(e)}))},update:function(){u(),c()},unstick:function(t){return this.each(function(){for(var t=this,o=e(t),n=-1,r=i.length;r-- >0;)i[r].stickyElement.get(0)===t&&(a.call(i,r,1),n=r);-1!==n&&(o.unwrap(),o.css({width:"",position:"",top:"",float:"","z-index":""}))})}};window.addEventListener?(window.addEventListener("scroll",c,!1),window.addEventListener("resize",u,!1)):window.attachEvent&&(window.attachEvent("onscroll",c),window.attachEvent("onresize",u)),e.fn.sticky=function(a){return d[a]?d[a].apply(this,t.call(arguments,1)):"object"!==(void 0===a?"undefined":s(a))&&a?void e.error("Method "+a+" does not exist on jQuery.sticky"):d.init.apply(this,arguments)},e.fn.unstick=function(a){return d[a]?d[a].apply(this,t.call(arguments,1)):"object"!==(void 0===a?"undefined":s(a))&&a?void e.error("Method "+a+" does not exist on jQuery.sticky"):d.unstick.apply(this,arguments)},e(function(){setTimeout(c,0)})})},qYg5:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},r=a("M4fF"),s=o(r),i=a("0iPh"),l=o(i);a("F8S1");var c=a("NYxO");t.default={props:{title:{default:""},size:{type:String,default:"modal-lgg"},fade:{type:Boolean,default:!1}},data:function(){return{q:"",online:"true",total:0,pageSize:10,currentPage:1,sort:"",order:"",loading:!1,channels:[],index:0}},computed:n({},(0,c.mapState)(["userInfo","serverInfo"])),watch:{q:function(e,t){this.doDelaySearch()},online:function(e,t){this.doSearch()},currentPage:function(e,t){this.doSearch(e)},pageSize:function(e,t){this.doSearch()}},mounted:function(){var e=this;(0,l.default)(this.$el).find(".modal-content").draggable({handle:".modal-header",cancel:".modal-title span",addClasses:!1,containment:"document",delay:100,opacity:.5}),(0,l.default)(this.$el).on("shown.bs.modal",function(){e.$emit("show")}).on("hidden.bs.modal",function(){e.errors.clear(),e.$emit("hide")})},methods:{sortChange:function(e){this.sort=e.prop,this.order="ascending"==e.order?"asc":"desc",this.getChannels()},doSearch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.currentPage=e,this.getChannels()},doDelaySearch:s.default.debounce(function(){this.doSearch()},800),formatName:function(e,t,a){var o=e.DeviceCustomName||e.DeviceName||"",n=e.CustomName||e.Name||"";return o&&o!=n&&(n=n?n+"@"+o:o),n||"-"},formatDeviceName:function(e,t,a){return e.DeviceCustomName||e.DeviceName||"-"},formatChannelName:function(e,t,a){return e.CustomName||e.Name||"-"},formatManufacturer:function(e,t,a){return a||"-"},getChannels:function(){var e=this;this.loading=!0,l.default.get("/api/v1/device/channellist",{q:this.q,start:(this.currentPage-1)*this.pageSize,limit:this.pageSize,channel_type:"device",online:this.online,sort:this.sort,order:this.order}).then(function(t){e.total=t.ChannelCount,e.channels=t.ChannelList||[]}).always(function(){e.$nextTick(function(){e.loading=!1})})},rowClick:function(e,t,a){"ON"===(e.CustomStatus||e.Status)&&(this.serverInfo.StrictChannelParental&&1==e.Parental||this.serverInfo.StrictChannelCode&&20!=e.ID.length||(this.$emit("selected",this.index,e),this.hide()))},rowDblclick:function(e,t,a){this.serverInfo.StrictChannelParental&&1==e.Parental||this.serverInfo.StrictChannelCode&&20!=e.ID.length||(this.$emit("selected",this.index,e),this.hide())},rowStyle:function(e){var t=e.row;e.rowIndex;return"ON"===(t.CustomStatus||t.Status)?this.serverInfo.StrictChannelParental&&1==t.Parental?"":this.serverInfo.StrictChannelCode&&20!=t.ID.length?"":"cursor:pointer":""},isDir:function(e){if(e){if(e.SubCount>0)return!0;if(this.serverInfo.StrictChannelParental&&1==e.Parental)return!0;if(this.serverInfo.StrictChannelCode&&e.ID.length<=10)return!0;if(1==e.Parental&&"LiveQing"==e.Manufacturer)return!0;if(20==e.ID.length&&("216"==e.ID.substring(10,13)||"215"==e.ID.substring(10,13)))return!0}return!1},reset:function(){this.index=0,this.channels=[],this.q="",this.online="true",this.currentPage=1,this.pageSize=10},show:function(e){this.index=e,(0,l.default)(this.$el).modal("show"),this.getChannels()},hide:function(){(0,l.default)(this.$el).modal("hide")}}}},qb8i:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a("F8S1");var o=a("0iPh"),n=function(e){return e&&e.__esModule?e:{default:e}}(o);t.default={props:{title:{default:"上传"},url:{type:String,default:""},multiple:{type:Boolean,default:!1},drag:{type:Boolean,default:!0},showFileList:{type:Boolean,default:!0},accept:{default:".xlsx"},tip:{default:"仅限上传.xlsx"},limit:{type:Number,default:0},autoUpload:{type:Boolean,default:!0}},data:function(){return{bShow:!1,bProgress:!1}},mounted:function(){var e=this;(0,n.default)(this.$el).find(".modal-content").draggable({handle:".modal-header",cancel:".modal-title span",addClasses:!1,containment:"document",delay:100,opacity:.5}),(0,n.default)(this.$el).on("shown.bs.modal",function(){e.$emit("show"),e.bShow=!0}).on("hidden.bs.modal",function(){e.$emit("hide"),e.bShow=!1,e.$refs.uploader.clearFiles()}).on("hide.bs.modal",function(){if(e.bProgress)return e.$message({type:"error",message:"正在上传, 请稍后..."}),!1})},methods:{show:function(){(0,n.default)(this.$el).modal("show")},hide:function(){(0,n.default)(this.$el).modal("hide")},beforeUpload:function(e){return!(this.limit&&e.size>this.limit)||(this.$message({type:"error",message:"文件["+e.name+"]大小超过限制["+this.limit+"], 不能上传!"}),!1)},onSuccess:function(e,t,a){var o=!0,n=!1,r=void 0;try{for(var s,i=a[Symbol.iterator]();!(o=(s=i.next()).done);o=!0){var l=s.value;if(100!=l.percentage&&0!==l.percentage)return void(this.bProgress=!0)}}catch(e){n=!0,r=e}finally{try{!o&&i.return&&i.return()}finally{if(n)throw r}}this.bProgress=!1,this.$emit("uploaded",t)},onProgress:function(e,t,a){this.bProgress=!0},onError:function(e,t,a){e&&this.$message({type:"error",message:e+""});var o=!0,n=!1,r=void 0;try{for(var s,i=a[Symbol.iterator]();!(o=(s=i.next()).done);o=!0){var l=s.value;if(100!=l.percentage&&0!==l.percentage)return void(this.bProgress=!0)}}catch(e){n=!0,r=e}finally{try{!o&&i.return&&i.return()}finally{if(n)throw r}}this.bProgress=!1},onRemove:function(e,t){var a=!0,o=!1,n=void 0;try{for(var r,s=t[Symbol.iterator]();!(a=(r=s.next()).done);a=!0){var i=r.value;if(100!=i.percentage&&0!==i.percentage)return void(this.bProgress=!0)}}catch(e){o=!0,n=e}finally{try{!a&&s.return&&s.return()}finally{if(o)throw n}}this.bProgress=!1}}}},rF1v:function(e,t,a){t=e.exports=a("FZ+f")(!1),t.push([e.i,".upload-dlg .modal-dialog .modal-body{overflow:hidden}.upload-dlg .modal-dialog .modal-body .el-upload{display:block}.upload-dlg .modal-dialog .modal-body .el-upload .el-upload-dragger{margin:0 auto}",""])},sJmG:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("2xaA"),n=a.n(o);for(var r in o)["default","default"].indexOf(r)<0&&function(e){a.d(t,e,function(){return o[e]})}(r);var s=a("kO2a"),i=a("VU/8"),l=i(n.a,s.a,!1,null,null,null);t.default=l.exports},sgWE:function(e,t,a){t=e.exports=a("FZ+f")(!1),t.push([e.i,".settings-block[data-v-ec71958a]{margin:30px auto;text-align:center}.ptz-block[data-v-ec71958a]{width:150px;height:180px;margin:0 auto;text-align:center;position:relative;font-size:24px}.ptz-block .ptz-cell[data-v-ec71958a]{width:50px;height:50px;line-height:50px;position:absolute}.ptz-block .ptz-cell.active[data-v-ec71958a]{color:#ccc;font-size:26px}.ptz-block .ptz-cell.readonly[data-v-ec71958a]{color:#ddd}.ptz-block .fa-microphone-slash[data-v-ec71958a],.ptz-block .fa-microphone[data-v-ec71958a]{padding:10px 13px;border-radius:25px}.ptz-block .fa-microphone.active[data-v-ec71958a]{color:#fff}.ptz-block .fa-microphone-slash.readonly[data-v-ec71958a],.ptz-block .fa-microphone.readonly[data-v-ec71958a]{color:#ddd}.ptz-block .mic-level-bar[data-v-ec71958a]{position:absolute;transform:rotate(-90deg);width:100%;top:70px;left:-80px}.ptz-block .ptz-center[data-v-ec71958a]{width:50px;height:50px;top:50px;left:50px;line-height:50px;border-radius:25px;background-color:#ccc}.ptz-block .ptz-up[data-v-ec71958a]{top:0;left:50px}.ptz-block .ptz-left[data-v-ec71958a]{top:50px;left:0}.ptz-block .ptz-right[data-v-ec71958a]{top:50px;left:100px}.ptz-block .ptz-down[data-v-ec71958a]{top:100px;left:50px}.ptz-block .ptz-zoomin[data-v-ec71958a]{top:150px;left:20px}.ptz-block .ptz-zoomout[data-v-ec71958a]{top:150px;left:80px}.ptz-block .ptz-talk[data-v-ec71958a]{top:150px;left:50px}.ptz-block .ptz-center>.fa-microphone[data-v-ec71958a],.ptz-block .ptz-down[data-v-ec71958a],.ptz-block .ptz-left[data-v-ec71958a],.ptz-block .ptz-right[data-v-ec71958a],.ptz-block .ptz-talk>.fa-microphone[data-v-ec71958a],.ptz-block .ptz-up[data-v-ec71958a],.ptz-block .ptz-zoomin[data-v-ec71958a],.ptz-block .ptz-zoomout[data-v-ec71958a]{cursor:pointer}.ptz-block .ptz-center>.fa-microphone.readonly[data-v-ec71958a],.ptz-block .ptz-down.readonly[data-v-ec71958a],.ptz-block .ptz-left.readonly[data-v-ec71958a],.ptz-block .ptz-right.readonly[data-v-ec71958a],.ptz-block .ptz-talk>.fa-microphone.readonly[data-v-ec71958a],.ptz-block .ptz-up.readonly[data-v-ec71958a],.ptz-block .ptz-zoomin.readonly[data-v-ec71958a],.ptz-block .ptz-zoomout.readonly[data-v-ec71958a]{cursor:auto}.ptz-block-fs[data-v-ec71958a]{position:fixed;margin:0;margin-bottom:50px;top:0;right:0;height:200px}.ptz-block-fs .ptz-center[data-v-ec71958a]{cursor:move;position:absolute}.ptz-block-fs .fa-microphone.active[data-v-ec71958a]{color:#ccc}.ptz-block-fs .ptz-zoomin[data-v-ec71958a]{left:15px}.ptz-block-fs .ptz-zoomout[data-v-ec71958a]{left:85px}",""])},uL6E:function(e,t,a){var o=a("IFhJ");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);a("rjj0")("145fd3d8",o,!0,{})},wZh5:function(e,t,a){"use strict";function o(e){a("b+at")}Object.defineProperty(t,"__esModule",{value:!0});var n=a("xi4u"),r=a.n(n);for(var s in n)["default","default"].indexOf(s)<0&&function(e){a.d(t,e,function(){return n[e]})}(s);var i=a("/DTV"),l=a("VU/8"),c=o,u=l(r.a,i.a,!1,c,"data-v-7950e622",null);t.default=u.exports},xi4u:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e};a("F8S1");var r=a("0iPh"),s=o(r),i=a("M4fF"),l=o(i),c=a("NYxO");t.default={props:{title:{default:""},size:{type:String,default:"modal-lgg"},fade:{type:Boolean,default:!1}},data:function(){return{q:"",channel_type:"",online:"",total:0,relateCnt:0,pageSize:10,currentPage:1,sort:"",order:"",related:!1,reverse:!1,loading:!1,channels:[],selection:[],bak:{},pcode:""}},computed:n({},(0,c.mapState)(["userInfo","serverInfo"])),watch:{q:function(e,t){this.doDelaySearch()},channel_type:function(e,t){this.doSearch()},online:function(e,t){this.doSearch()},related:function(e,t){this.doSearch()},reverse:function(e,t){this.doSearch()},currentPage:function(e,t){this.doSearch(e)},pageSize:function(e,t){this.doSearch()}},mounted:function(){var e=this;(0,s.default)(this.$el).find(".modal-content").draggable({handle:".modal-header",cancel:".modal-title span",addClasses:!1,containment:"document",delay:100,opacity:.5}),(0,s.default)(this.$el).on("shown.bs.modal",function(){e.$emit("show")}).on("hidden.bs.modal",function(){e.errors.clear(),e.reset(),e.$emit("hide")})},directives:{focus:{inserted:function(e){e.focus(),e.select()}}},methods:{sortChange:function(e){this.sort=e.prop,this.order="ascending"==e.order?"asc":"desc",this.getChannels()},select:function(e,t){var a=this;if(e.indexOf(t)>=0)s.default.get("/api/v1/channel/setcustomparent",{customs:[t.DeviceID+":"+t.ID+":"+this.pcode]}).then(function(){a.bak[t.DeviceID+":"+t.ID]=t.CustomParentID||""}).always(function(){a.getChannels()});else{var o=this.bak[t.DeviceID+":"+t.ID]||"";s.default.get("/api/v1/channel/setcustomparent",{customs:[t.DeviceID+":"+t.ID+":"+o]}).always(function(){a.getChannels()})}},selectAll:function(e){var t=this,a=[],o={};if(e.length){var n=!0,r=!1,i=void 0;try{for(var l,c=e[Symbol.iterator]();!(n=(l=c.next()).done);n=!0){var u=l.value;this.selection.indexOf(u)<0&&(a.push(u.DeviceID+":"+u.ID+":"+this.pcode),o[u.DeviceID+":"+u.ID]=u.CustomParentID||"")}}catch(e){r=!0,i=e}finally{try{!n&&c.return&&c.return()}finally{if(r)throw i}}s.default.get("/api/v1/channel/setcustomparent",{customs:a}).then(function(){t.bak=Object.assign(t.bak,o)}).always(function(){t.getChannels()})}else{var d=!0,f=!1,p=void 0;try{for(var h,m=this.selection[Symbol.iterator]();!(d=(h=m.next()).done);d=!0){var u=h.value,v=this.bak[u.DeviceID+":"+u.ID]||"";a.push(u.DeviceID+":"+u.ID+":"+v)}}catch(e){f=!0,p=e}finally{try{!d&&m.return&&m.return()}finally{if(f)throw p}}s.default.get("/api/v1/channel/setcustomparent",{customs:a}).always(function(){t.getChannels()})}},doSearch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.currentPage=e,this.getChannels()},doDelaySearch:l.default.debounce(function(){this.doSearch()},800),formatName:function(e,t,a){var o=e.DeviceCustomName||e.DeviceName||"",n=e.CustomName||e.Name||"";return o&&o!=n&&(n=n?n+"@"+o:o),n||"-"},formatDeviceName:function(e,t,a){return e.DeviceCustomName||e.DeviceName||"-"},formatChannelName:function(e,t,a){return e.CustomName||e.Name||"-"},formatManufacturer:function(e,t,a){return a||"-"},selectable:function(e,t){return!0},getChannels:function(){var e=this;this.pcode&&(this.loading=!0,s.default.get("/api/v1/channel/customlist",{pcode:this.pcode,q:this.q,start:(this.currentPage-1)*this.pageSize,limit:this.pageSize,channel_type:this.channel_type,online:"device"==this.channel_type?this.online:"",related:this.related,reverse:this.reverse,sort:this.sort,order:this.order}).then(function(t){e.$refs.channelTable.clearSelection(),e.total=t.ChannelCount,e.relateCnt=t.ChannelRelateCount,e.channels=t.ChannelList||[],e.selection=[],e.$nextTick(function(){e.channels.forEach(function(t){var a=t.CustomParentID==e.pcode;e.$refs.channelTable.toggleRowSelection(t,a),a&&e.selection.push(t)})})}).always(function(){e.$nextTick(function(){e.loading=!1})}))},isDir:function(e){if(e){if(e.SubCount>0)return!0;if(this.serverInfo.StrictChannelParental&&1==e.Parental)return!0;if(this.serverInfo.StrictChannelCode&&e.ID.length<=10)return!0;if(1==e.Parental&&"LiveQing"==e.Manufacturer)return!0;if(20==e.ID.length&&("216"==e.ID.substring(10,13)||"215"==e.ID.substring(10,13)))return!0}return!1},reset:function(){this.pcode="",this.$refs.channelTable.clearSelection(),this.channels=[],this.selection=[],this.bak={},this.q="",this.channel_type="",this.online="",this.related=!1,this.reverse=!1,this.total=0,this.relateCnt=0,this.currentPage=1,this.pageSize=10},setChannelID:function(e,t,a){var o=e.Editing;if(this.$set(e,"Editing",t),o&&!t){var n=a.target.value.trim();n==e.ID&&(n=""),e.CustomID!=n&&s.default.get("/api/v1/device/setchannelid",{serial:e.DeviceID,code:e.ID,id:n}).then(function(t){e.CustomID=n})}},show:function(e){this.pcode=e,(0,s.default)(this.$el).modal("show"),this.getChannels()},hide:function(){(0,s.default)(this.$el).modal("hide")},toggleReverse:function(){this.reverse=!this.reverse}}}}});